<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>adultincome – stephenpierzchajlo.com</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../images/favicon.ico" rel="icon">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-md " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">stephenpierzchajlo.com</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../content/about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://x.com/pierzchajlo"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/StephenPierzchajlo"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">




<h1>
Table of Contents<span class="tocSkip"></span>
</h1>
<div class="toc">
<ul class="toc-item">
<li>
<span><a href="#Census-Income-Data-Set" data-toc-modified-id="Census-Income-Data-Set-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Census Income Data Set</a></span>
<ul class="toc-item">
<li>
<span><a href="#Introduction" data-toc-modified-id="Introduction-1.1"><span class="toc-item-num">1.1&nbsp;&nbsp;</span>Introduction</a></span>
</li>
<li>
<span><a href="#Data-Description" data-toc-modified-id="Data-Description-1.2"><span class="toc-item-num">1.2&nbsp;&nbsp;</span>Data Description</a></span>
</li>
<li>
<span><a href="#Categorical-Attributes" data-toc-modified-id="Categorical-Attributes-1.3"><span class="toc-item-num">1.3&nbsp;&nbsp;</span>Categorical Attributes</a></span>
</li>
<li>
<span><a href="#Continuous-Attributes" data-toc-modified-id="Continuous-Attributes-1.4"><span class="toc-item-num">1.4&nbsp;&nbsp;</span>Continuous Attributes</a></span>
</li>
</ul>
</li>
<li>
<span><a href="#Setup" data-toc-modified-id="Setup-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Setup</a></span>
<ul class="toc-item">
<li>
<span><a href="#Load-Libraries" data-toc-modified-id="Load-Libraries-2.1"><span class="toc-item-num">2.1&nbsp;&nbsp;</span>Load Libraries</a></span>
</li>
<li>
<span><a href="#Suppress-Warnings" data-toc-modified-id="Suppress-Warnings-2.2"><span class="toc-item-num">2.2&nbsp;&nbsp;</span>Suppress Warnings</a></span>
</li>
<li>
<span><a href="#Set-Seed" data-toc-modified-id="Set-Seed-2.3"><span class="toc-item-num">2.3&nbsp;&nbsp;</span>Set Seed</a></span>
</li>
<li>
<span><a href="#Display-Options" data-toc-modified-id="Display-Options-2.4"><span class="toc-item-num">2.4&nbsp;&nbsp;</span>Display Options</a></span>
</li>
<li>
<span><a href="#Path-Manager" data-toc-modified-id="Path-Manager-2.5"><span class="toc-item-num">2.5&nbsp;&nbsp;</span>Path Manager</a></span>
</li>
<li>
<span><a href="#Define-Custom-Functions" data-toc-modified-id="Define-Custom-Functions-2.6"><span class="toc-item-num">2.6&nbsp;&nbsp;</span>Define Custom Functions</a></span>
</li>
<li>
<span><a href="#Load-Data" data-toc-modified-id="Load-Data-2.7"><span class="toc-item-num">2.7&nbsp;&nbsp;</span>Load Data</a></span>
</li>
<li>
<span><a href="#Check-Data-Structure" data-toc-modified-id="Check-Data-Structure-2.8"><span class="toc-item-num">2.8&nbsp;&nbsp;</span>Check Data Structure</a></span>
</li>
</ul>
</li>
<li>
<span><a href="#Missing-Data" data-toc-modified-id="Missing-Data-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Missing Data</a></span>
<ul class="toc-item">
<li>
<span><a href="#Missing-Data-List" data-toc-modified-id="Missing-Data-List-3.1"><span class="toc-item-num">3.1&nbsp;&nbsp;</span>Missing Data List</a></span>
</li>
</ul>
</li>
<li>
<span><a href="#Assess-Predictors" data-toc-modified-id="Assess-Predictors-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>Assess Predictors</a></span>
<ul class="toc-item">
<li>
<span><a href="#Workclass" data-toc-modified-id="Workclass-4.1"><span class="toc-item-num">4.1&nbsp;&nbsp;</span>Workclass</a></span>
</li>
<li>
<span><a href="#Education" data-toc-modified-id="Education-4.2"><span class="toc-item-num">4.2&nbsp;&nbsp;</span>Education</a></span>
</li>
<li>
<span><a href="#Marital-status" data-toc-modified-id="Marital-status-4.3"><span class="toc-item-num">4.3&nbsp;&nbsp;</span>Marital-status</a></span>
</li>
<li>
<span><a href="#Occupation" data-toc-modified-id="Occupation-4.4"><span class="toc-item-num">4.4&nbsp;&nbsp;</span>Occupation</a></span>
</li>
<li>
<span><a href="#Relationship" data-toc-modified-id="Relationship-4.5"><span class="toc-item-num">4.5&nbsp;&nbsp;</span>Relationship</a></span>
</li>
<li>
<span><a href="#Race" data-toc-modified-id="Race-4.6"><span class="toc-item-num">4.6&nbsp;&nbsp;</span>Race</a></span>
</li>
<li>
<span><a href="#Gender" data-toc-modified-id="Gender-4.7"><span class="toc-item-num">4.7&nbsp;&nbsp;</span>Gender</a></span>
</li>
<li>
<span><a href="#Native-Country" data-toc-modified-id="Native-Country-4.8"><span class="toc-item-num">4.8&nbsp;&nbsp;</span>Native-Country</a></span>
</li>
<li>
<span><a href="#Capital-Gain/Capital-Loss" data-toc-modified-id="Capital-Gain/Capital-Loss-4.9"><span class="toc-item-num">4.9&nbsp;&nbsp;</span>Capital-Gain/Capital-Loss</a></span>
</li>
<li>
<span><a href="#Age" data-toc-modified-id="Age-4.10"><span class="toc-item-num">4.10&nbsp;&nbsp;</span>Age</a></span>
</li>
<li>
<span><a href="#Hours-per-week" data-toc-modified-id="Hours-per-week-4.11"><span class="toc-item-num">4.11&nbsp;&nbsp;</span>Hours-per-week</a></span>
</li>
<li>
<span><a href="#Capital_diff" data-toc-modified-id="Capital_diff-4.12"><span class="toc-item-num">4.12&nbsp;&nbsp;</span>Capital_diff</a></span>
</li>
<li>
<span><a href="#Scaling-continuous-variables" data-toc-modified-id="Scaling-continuous-variables-4.13"><span class="toc-item-num">4.13&nbsp;&nbsp;</span>Scaling continuous variables</a></span>
</li>
<li>
<span><a href="#fnlwgt" data-toc-modified-id="fnlwgt-4.14"><span class="toc-item-num">4.14&nbsp;&nbsp;</span>fnlwgt</a></span>
</li>
</ul>
</li>
<li>
<span><a href="#Final-Data-Tweaks" data-toc-modified-id="Final-Data-Tweaks-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>Final Data Tweaks</a></span>
<ul class="toc-item">
<li>
<span><a href="#Dummy-Coding" data-toc-modified-id="Dummy-Coding-5.1"><span class="toc-item-num">5.1&nbsp;&nbsp;</span>Dummy Coding</a></span>
</li>
<li>
<span><a href="#Check-For-Duplicate-Columns" data-toc-modified-id="Check-For-Duplicate-Columns-5.2"><span class="toc-item-num">5.2&nbsp;&nbsp;</span>Check For Duplicate Columns</a></span>
</li>
</ul>
</li>
<li>
<span><a href="#Machine-Learning-Model" data-toc-modified-id="Machine-Learning-Model-6"><span class="toc-item-num">6&nbsp;&nbsp;</span>Machine Learning Model</a></span>
<ul class="toc-item">
<li>
<span><a href="#Define-Predictors-And-Response-Variable" data-toc-modified-id="Define-Predictors-And-Response-Variable-6.1"><span class="toc-item-num">6.1&nbsp;&nbsp;</span>Define Predictors And Response Variable</a></span>
</li>
<li>
<span><a href="#Define-Training,-Validation,-And-Testing-Sets" data-toc-modified-id="Define-Training,-Validation,-And-Testing-Sets-6.2"><span class="toc-item-num">6.2&nbsp;&nbsp;</span>Define Training, Validation, And Testing Sets</a></span>
</li>
<li>
<span><a href="#Testing-Different-Classifiers" data-toc-modified-id="Testing-Different-Classifiers-6.3"><span class="toc-item-num">6.3&nbsp;&nbsp;</span>Testing Different Classifiers</a></span>
</li>
<li>
<span><a href="#Stacked-Model" data-toc-modified-id="Stacked-Model-6.4"><span class="toc-item-num">6.4&nbsp;&nbsp;</span>Stacked Model</a></span>
</li>
<li>
<span><a href="#XGBoost-Base-Model" data-toc-modified-id="XGBoost-Base-Model-6.5"><span class="toc-item-num">6.5&nbsp;&nbsp;</span>XGBoost Base Model</a></span>
</li>
<li>
<span><a href="#XGBoost-Grid-Search" data-toc-modified-id="XGBoost-Grid-Search-6.6"><span class="toc-item-num">6.6&nbsp;&nbsp;</span>XGBoost Grid Search</a></span>
</li>
</ul>
</li>
<li>
<span><a href="#Model-Evaluation" data-toc-modified-id="Model-Evaluation-7"><span class="toc-item-num">7&nbsp;&nbsp;</span>Model Evaluation</a></span>
<ul class="toc-item">
<li>
<span><a href="#Validation-Curve" data-toc-modified-id="Validation-Curve-7.1"><span class="toc-item-num">7.1&nbsp;&nbsp;</span>Validation Curve</a></span>
</li>
<li>
<span><a href="#Learning-Curve" data-toc-modified-id="Learning-Curve-7.2"><span class="toc-item-num">7.2&nbsp;&nbsp;</span>Learning Curve</a></span>
</li>
</ul>
</li>
<li>
<span><a href="#Metrics-And-Classification-Evaluation" data-toc-modified-id="Metrics-And-Classification-Evaluation-8"><span class="toc-item-num">8&nbsp;&nbsp;</span>Metrics And Classification Evaluation</a></span>
<ul class="toc-item">
<li>
<span><a href="#Confusion-Matrix" data-toc-modified-id="Confusion-Matrix-8.1"><span class="toc-item-num">8.1&nbsp;&nbsp;</span>Confusion Matrix</a></span>
</li>
<li>
<span><a href="#Accuracy" data-toc-modified-id="Accuracy-8.2"><span class="toc-item-num">8.2&nbsp;&nbsp;</span>Accuracy</a></span>
<ul class="toc-item">
<li>
<span><a href="#Manual-Calculation" data-toc-modified-id="Manual-Calculation-8.2.1"><span class="toc-item-num">8.2.1&nbsp;&nbsp;</span>Manual Calculation</a></span>
</li>
<li>
<span><a href="#ScikitLearn-Calculation" data-toc-modified-id="ScikitLearn-Calculation-8.2.2"><span class="toc-item-num">8.2.2&nbsp;&nbsp;</span>ScikitLearn Calculation</a></span>
</li>
</ul>
</li>
<li>
<span><a href="#Recall/Sensitivity-(True-Positive-Rate)" data-toc-modified-id="Recall/Sensitivity-(True-Positive-Rate)-8.3"><span class="toc-item-num">8.3&nbsp;&nbsp;</span>Recall/Sensitivity (True Positive Rate)</a></span>
<ul class="toc-item">
<li>
<span><a href="#Manual-Calculation" data-toc-modified-id="Manual-Calculation-8.3.1"><span class="toc-item-num">8.3.1&nbsp;&nbsp;</span>Manual Calculation</a></span>
</li>
<li>
<span><a href="#ScikitLearn-Calculation" data-toc-modified-id="ScikitLearn-Calculation-8.3.2"><span class="toc-item-num">8.3.2&nbsp;&nbsp;</span>ScikitLearn Calculation</a></span>
</li>
</ul>
</li>
<li>
<span><a href="#Precision" data-toc-modified-id="Precision-8.4"><span class="toc-item-num">8.4&nbsp;&nbsp;</span>Precision</a></span>
<ul class="toc-item">
<li>
<span><a href="#Manual-Calculation" data-toc-modified-id="Manual-Calculation-8.4.1"><span class="toc-item-num">8.4.1&nbsp;&nbsp;</span>Manual Calculation</a></span>
</li>
<li>
<span><a href="#ScikitLearn-Calculation" data-toc-modified-id="ScikitLearn-Calculation-8.4.2"><span class="toc-item-num">8.4.2&nbsp;&nbsp;</span>ScikitLearn Calculation</a></span>
</li>
</ul>
</li>
<li>
<span><a href="#F1-(Harmonic-Mean)" data-toc-modified-id="F1-(Harmonic-Mean)-8.5"><span class="toc-item-num">8.5&nbsp;&nbsp;</span>F1 (Harmonic Mean)</a></span>
<ul class="toc-item">
<li>
<span><a href="#Manual-Calculation" data-toc-modified-id="Manual-Calculation-8.5.1"><span class="toc-item-num">8.5.1&nbsp;&nbsp;</span>Manual Calculation</a></span>
</li>
<li>
<span><a href="#ScikitLearn-Calculation" data-toc-modified-id="ScikitLearn-Calculation-8.5.2"><span class="toc-item-num">8.5.2&nbsp;&nbsp;</span>ScikitLearn Calculation</a></span>
</li>
</ul>
</li>
<li>
<span><a href="#Classification-Report" data-toc-modified-id="Classification-Report-8.6"><span class="toc-item-num">8.6&nbsp;&nbsp;</span>Classification Report</a></span>
</li>
<li>
<span><a href="#ROC" data-toc-modified-id="ROC-8.7"><span class="toc-item-num">8.7&nbsp;&nbsp;</span>ROC</a></span>
</li>
<li>
<span><a href="#Precision-Recall-Curve" data-toc-modified-id="Precision-Recall-Curve-8.8"><span class="toc-item-num">8.8&nbsp;&nbsp;</span>Precision-Recall Curve</a></span>
</li>
<li>
<span><a href="#Cumulative-Gains-Plot" data-toc-modified-id="Cumulative-Gains-Plot-8.9"><span class="toc-item-num">8.9&nbsp;&nbsp;</span>Cumulative Gains Plot</a></span>
</li>
<li>
<span><a href="#Lift-Curve" data-toc-modified-id="Lift-Curve-8.10"><span class="toc-item-num">8.10&nbsp;&nbsp;</span>Lift Curve</a></span>
</li>
<li>
<span><a href="#Class-Prediction-Error" data-toc-modified-id="Class-Prediction-Error-8.11"><span class="toc-item-num">8.11&nbsp;&nbsp;</span>Class Prediction Error</a></span>
</li>
<li>
<span><a href="#Discrimination-Threshold" data-toc-modified-id="Discrimination-Threshold-8.12"><span class="toc-item-num">8.12&nbsp;&nbsp;</span>Discrimination Threshold</a></span>
</li>
</ul>
</li>
<li>
<span><a href="#Tuning-Decision-Threshold" data-toc-modified-id="Tuning-Decision-Threshold-9"><span class="toc-item-num">9&nbsp;&nbsp;</span>Tuning Decision Threshold</a></span>
<ul class="toc-item">
<li>
<span><a href="#Identify-Everyone-Making-<=50K" data-toc-modified-id="Identify-Everyone-Making-<=50K-9.1"><span class="toc-item-num">9.1&nbsp;&nbsp;</span>Identify Everyone Making &lt;=50K</a></span>
</li>
<li>
<span><a href="#Correctly-Identify-Everyone-Making-<=50K" data-toc-modified-id="Correctly-Identify-Everyone-Making-<=50K-9.2"><span class="toc-item-num">9.2&nbsp;&nbsp;</span>Correctly Identify Everyone Making &lt;=50K</a></span>
</li>
</ul>
</li>
<li>
<span><a href="#Model-Exploration" data-toc-modified-id="Model-Exploration-10"><span class="toc-item-num">10&nbsp;&nbsp;</span>Model Exploration</a></span>
<ul class="toc-item">
<li>
<span><a href="#Shapley-Additive-Explanations-(SHAP)" data-toc-modified-id="Shapley-Additive-Explanations-(SHAP)-10.1"><span class="toc-item-num">10.1&nbsp;&nbsp;</span>Shapley Additive Explanations (SHAP)</a></span>
</li>
<li>
<span><a href="#Force-Plot" data-toc-modified-id="Force-Plot-10.2"><span class="toc-item-num">10.2&nbsp;&nbsp;</span>Force Plot</a></span>
<ul class="toc-item">
<li>
<span><a href="#<=50K-Force-Plot" data-toc-modified-id="<=50K-Force-Plot-10.2.1"><span class="toc-item-num">10.2.1&nbsp;&nbsp;</span>&lt;=50K Force Plot</a></span>
</li>
<li>
<span><a href="#>50K-Force-Plot" data-toc-modified-id=">50K-Force-Plot-10.2.2"><span class="toc-item-num">10.2.2&nbsp;&nbsp;</span>&gt;50K Force Plot</a></span>
</li>
</ul>
</li>
<li>
<span><a href="#Bee-Swarm-Plot" data-toc-modified-id="Bee-Swarm-Plot-10.3"><span class="toc-item-num">10.3&nbsp;&nbsp;</span>Bee Swarm Plot</a></span>
</li>
<li>
<span><a href="#SHAP-Bar-Plot" data-toc-modified-id="SHAP-Bar-Plot-10.4"><span class="toc-item-num">10.4&nbsp;&nbsp;</span>SHAP Bar Plot</a></span>
</li>
<li>
<span><a href="#SHAP-Dot-Plot" data-toc-modified-id="SHAP-Dot-Plot-10.5"><span class="toc-item-num">10.5&nbsp;&nbsp;</span>SHAP Dot Plot</a></span>
<ul class="toc-item">
<li>
<span><a href="#SHAP-Dot-Plot:-gender_Male" data-toc-modified-id="SHAP-Dot-Plot:-gender_Male-10.5.1"><span class="toc-item-num">10.5.1&nbsp;&nbsp;</span>SHAP Dot Plot: gender_Male</a></span>
</li>
<li>
<span><a href="#SHAP-Dot-Plot:-gender_Male" data-toc-modified-id="SHAP-Dot-Plot:-gender_Male-10.5.2"><span class="toc-item-num">10.5.2&nbsp;&nbsp;</span>SHAP Dot Plot: gender_Male</a></span>
</li>
</ul>
</li>
</ul>
</li>
<li>
<span><a href="#Conclusion" data-toc-modified-id="Conclusion-11"><span class="toc-item-num">11&nbsp;&nbsp;</span>Conclusion</a></span>
</li>
</ul>
</div>
<section id="census-income-data-set" class="level1">
<h1>Census Income Data Set</h1>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>A census is the procedure of systematically acquiring and recording information about the members of a given population. The census is a special, wide-range activity, which takes place once a decade in the entire country. The purpose is to gather information about the general population, in order to present a full and reliable picture of the population in the country - its housing conditions and demographic, social and economic characteristics. The information collected includes data on age, gender, country of origin, marital status, housing conditions, marriage, education, employment, etc.</p>
</section>
<section id="data-description" class="level2">
<h2 class="anchored" data-anchor-id="data-description">Data Description</h2>
<p>This data was extracted from the 1994 Census bureau database by Ronny Kohavi and Barry Becker (Data Mining and Visualization, Silicon Graphics). The prediction task is to determine whether a person makes less than $50K a year.</p>
</section>
<section id="categorical-attributes" class="level2">
<h2 class="anchored" data-anchor-id="categorical-attributes">Categorical Attributes</h2>
<p>Below is a description of all categorical predictors in the dataset.</p>
<ul>
<li><strong>workclass</strong>: Individual work category <br>
<ul>
<li>levels: Private, Self-emp-not-inc, Self-emp-inc, Federal-gov, Local-gov, State-gov, Without-pay, Never-worked. <br> <br></li>
</ul></li>
<li><strong>education</strong>: Individual’s highest education degree <br>
<ul>
<li>levels: Bachelors, Some-college, 11th, HS-grad, Prof-school, Assoc-acdm, Assoc-voc, 9th, 7th-8th, 12th, Masters, 1st-4th, 10th, Doctorate, 5th-6th, Preschool. <br> <br></li>
</ul></li>
<li><strong>marital-status</strong>: Individual marital status <br>
<ul>
<li>levels: Married-civ-spouse, Divorced, Never-married, Separated, Widowed, Married-spouse-absent, Married-AF-spouse. <br> <br></li>
</ul></li>
<li><strong>occupation</strong>: Individual’s occupation <br>
<ul>
<li>levels: Tech-support, Craft-repair, Other-service, Sales, Exec-managerial, Prof-specialty, Handlers-cleaners, Machine-op-inspct, Adm-clerical, Farming-fishing, Transport-moving, Priv-house-serv, Protective-serv, Armed-Forces. <br> <br></li>
</ul></li>
<li><strong>relationship</strong>: Individual’s relation in a family <br>
<ul>
<li>levels: Wife, Own-child, Husband, Not-in-family, Other-relative, Unmarried. <br> <br></li>
</ul></li>
<li><strong>race</strong>: Race of Individual <br>
<ul>
<li>levels: White, Asian-Pac-Islander, Amer-Indian-Eskimo, Other, Black. <br> <br></li>
</ul></li>
<li><strong>sex</strong>: Individual’s sex <br>
<ul>
<li>levels: Female, Male. <br> <br></li>
</ul></li>
<li><strong>native-country</strong>: Individual’s native country <br>
<ul>
<li>levels: United-States, Cambodia, England, Puerto-Rico, Canada, Germany, Outlying-US(Guam-USVI-etc), India, Japan, Greece, South, China, Cuba, Iran, Honduras, Philippines, Italy, Poland, Jamaica, Vietnam, Mexico, Portugal, Ireland, France, Dominican-Republic, Laos, Ecuador, Taiwan, Haiti, Columbia, Hungary, Guatemala, Nicaragua, Scotland, Thailand, Yugoslavia, El-Salvador, Trinadad&amp;Tobago, Peru, Hong, Holand-Netherlands. <br> <br></li>
</ul></li>
</ul>
</section>
<section id="continuous-attributes" class="level2">
<h2 class="anchored" data-anchor-id="continuous-attributes">Continuous Attributes</h2>
<p>Below is a description of all the continuous predictors in the dataset.</p>
<ul>
<li><strong>age</strong>: Age of an individual <br></li>
<li><strong>fnlwgt</strong>: final weight <br></li>
<li><strong>capital-gain</strong> <br></li>
<li><strong>capital-loss</strong> <br></li>
<li><strong>hours-per-week</strong>: Individual’s working hour per week</li>
</ul>
</section>
</section>
<section id="setup" class="level1">
<h1>Setup</h1>
<p>Here is what I do to set up my data science environment.</p>
<section id="load-libraries" class="level2">
<h2 class="anchored" data-anchor-id="load-libraries">Load Libraries</h2>
<div id="cell-8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import packages.</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scikitplot</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> missingno <span class="im">as</span> msno</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> pathlib <span class="im">import</span> Path</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> lime <span class="im">import</span> lime_tabular</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> shap</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> ensemble, preprocessing, tree, model_selection, metrics</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.dummy <span class="im">import</span> DummyClassifier</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.naive_bayes <span class="im">import</span> GaussianNB</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.svm <span class="im">import</span> SVC</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix, roc_auc_score, f1_score, precision_score, recall_score, accuracy_score</span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> StratifiedKFold</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xgboost</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mlxtend.classifier <span class="im">import</span> StackingClassifier</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> yellowbrick.classifier <span class="im">import</span> ConfusionMatrix, ROCAUC, ClassificationReport, PrecisionRecallCurve, DiscriminationThreshold, ClassPredictionError, ClassBalance</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> yellowbrick.model_selection <span class="im">import</span> LearningCurve, ValidationCurve</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="suppress-warnings" class="level2">
<h2 class="anchored" data-anchor-id="suppress-warnings">Suppress Warnings</h2>
<p>Warnings usually don’t relate to anything that will affect the actual analysis, so I turn them off.</p>
<div id="cell-10" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Turn warnings off globally.</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> warn(<span class="op">*</span>args, <span class="op">**</span>kwargs):</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">pass</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#import warnings</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>warnings.warn <span class="op">=</span> warn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="set-seed" class="level2">
<h2 class="anchored" data-anchor-id="set-seed">Set Seed</h2>
<div id="cell-12" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Seed for reproducibility.</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>random.seed(<span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="display-options" class="level2">
<h2 class="anchored" data-anchor-id="display-options">Display Options</h2>
<div id="cell-14" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display all dataframe columns.</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_columns'</span>, <span class="va">None</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display all dataframe rows.</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>pd.set_option(<span class="st">'display.max_rows'</span>, <span class="va">None</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="path-manager" class="level2">
<h2 class="anchored" data-anchor-id="path-manager">Path Manager</h2>
<div id="cell-16" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make project folder working directory.</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>cd <span class="st">"C:\Users\STPI0560\Desktop\Python Projects\Adult Income"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>C:\Users\STPI0560\Desktop\Python Projects\Adult Income</code></pre>
</div>
</div>
</section>
<section id="define-custom-functions" class="level2">
<h2 class="anchored" data-anchor-id="define-custom-functions">Define Custom Functions</h2>
<p>If I do something similar more than once, I will write a function so as not to clutter up the workspace. Each of these functions will be run multiple times throughout this analysis.</p>
<div id="cell-18" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %load "bin\getDuplicateColumns.py"</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> getDuplicateColumns(df):</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Get a list of duplicate columns.</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co">    It will iterate over all the columns in dataframe and find the columns whose contents are duplicate.</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co">    :param df: Dataframe object</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co">    :return: List of columns whose contents are duplicates.</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define empty set.</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>    duplicateColumnNames <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Iterate over all the columns in dataframe</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(df.shape[<span class="dv">1</span>]):</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Select column at xth index.</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>        col <span class="op">=</span> df.iloc[:, x]</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Iterate over all the columns in DataFrame from (x+1)th index till end</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> y <span class="kw">in</span> <span class="bu">range</span>(x <span class="op">+</span> <span class="dv">1</span>, df.shape[<span class="dv">1</span>]):</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Select column at yth index.</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>            otherCol <span class="op">=</span> df.iloc[:, y]</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Check if two columns at x 7 y index are equal</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> col.equals(otherCol):</span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>                duplicateColumnNames.add(df.columns.values[y])</span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(duplicateColumnNames)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-19" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %load "bin\plotPredictors.py"</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plotPredictors(data, predictor, width, height):</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Return a plot with frequency of categorical variables for an inputed predictor.</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">    data: Input dataframe in pandas format.</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">    predictor: Name of predictor column, in quotes ("").</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="co">    width: Width of plot.</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">    height: Height of plot.</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set plot size.</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize <span class="op">=</span> (width, height))</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Set title.</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    plt.title(predictor)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Define graph.</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> sns.countplot(x <span class="op">=</span> predictor, data <span class="op">=</span> data, hue <span class="op">=</span> <span class="st">"income"</span>)</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># If predictor is occupation, tilt x-axis labels (so they fit)...</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> predictor <span class="op">==</span> <span class="st">"occupation"</span> <span class="kw">or</span> <span class="st">"native_country"</span>:</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>        plt.xticks(rotation<span class="op">=</span><span class="dv">30</span>)</span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> p <span class="kw">in</span> ax.patches:</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>            height <span class="op">=</span> p.get_height()</span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> plt.show()</span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="co"># ... otherwise, don't tilt x-axis labels.</span></span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> p <span class="kw">in</span> ax.patches:</span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>            height <span class="op">=</span> p.get_height()</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-20" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># %load "bin\testClassifiers.py"</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> testClassifiers(classifierList, X_train, y_train, X_vl, y_val):</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">    Return a dataframe with 1 row for each classifier inputed in the function's</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co">    arguements. Each row contains: Classifier name, accuracy, recall score, and</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co">    precision score.</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="co">    data: Input: classifierList, X_train, y_train, X_test, y_test. </span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co">    classifierList: List of classifiers you want to test. </span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a><span class="co">    Example: [DecisionTreeClassifier, KNeighborsClassifier, GaussianNB].</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">    X_train: Matrix of training predictors (numeric).</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co">    y_train: Vector of training response variable identity (numeric).</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co">    X_test: Matrix of testing predictors (numeric).</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">    y_test: Vector of testing response variable identity (numeric).</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make empty dataframe.</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>    model_df <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">'Classifier'</span>, <span class="st">'Accuracy'</span>, <span class="st">'Recall'</span>, <span class="st">'Precision'</span>, <span class="st">'f1'</span>])</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Repeat for each classifier in the list defined in the functions arguement.</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> classifierList:</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For each model:</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> i()</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get model name from current classifier.</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>        model_name <span class="op">=</span> <span class="bu">type</span>(model).<span class="va">__name__</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Fit the data with the training model.</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>        model.fit(X_train, y_train)</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># make predictions on test data using training model.</span></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>        yhat <span class="op">=</span> model.predict(X_val)</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>        <span class="co"># test accuracy for current model.</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>        acc <span class="op">=</span> accuracy_score(y_val, yhat)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>        <span class="co"># test recall for current model</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>        recall <span class="op">=</span> recall_score(y_val, yhat)</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>        <span class="co"># test precision for current model.</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>        precision <span class="op">=</span> precision_score(y_val, yhat)</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>        f1 <span class="op">=</span> f1_score(y_val, yhat)</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create list for model i with caculated information.</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>        row <span class="op">=</span> [model_name, acc, recall, precision, f1]</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add list as new row in model_df.</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>        model_df.loc[<span class="bu">len</span>(model_df)] <span class="op">=</span> row</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return dataframe with performance of each model.</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-21" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> testxgboost(classifierList, X_train, y_train, X_vl, y_val):</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">'''</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">    Return a dataframe with 1 row for each classifier inputed in the function's</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">    arguements. Each row contains: Classifier name, accuracy, recall score, and</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">    precision score.</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">    data: Input: classifierList, X_train, y_train, X_test, y_test. </span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co">    classifierList: List of classifiers you want to test. </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Example: [DecisionTreeClassifier, KNeighborsClassifier, GaussianNB].</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co">    X_train: Matrix of training predictors (numeric).</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">    y_train: Vector of training response variable identity (numeric).</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a><span class="co">    X_test: Matrix of testing predictors (numeric).</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="co">    y_test: Vector of testing response variable identity (numeric).</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">    '''</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Make empty dataframe.</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>    model_df <span class="op">=</span> pd.DataFrame(columns<span class="op">=</span>[<span class="st">'Classifier'</span>, <span class="st">'Accuracy'</span>, <span class="st">'Recall'</span>, <span class="st">'Precision'</span>, <span class="st">'f1'</span>])</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Repeat for each classifier in the list defined in the functions arguement.</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> classifierList:</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># For each model:</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>        model <span class="op">=</span> i(random_state <span class="op">=</span> <span class="dv">42</span>,</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>                              eta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>                              ubsample <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>                              colsample_bytree <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>                              max_depth <span class="op">=</span> <span class="dv">4</span>,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>                              min_child_weight <span class="op">=</span> <span class="dv">1</span>,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>                             use_label_encoder <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Get model name from current classifier.</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        model_name <span class="op">=</span> <span class="bu">type</span>(model).<span class="va">__name__</span></span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Fit the data with the training model.</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>        model.fit(X_train, y_train)</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>        <span class="co"># make predictions on test data using training model.</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>        yhat <span class="op">=</span> model.predict(X_val)</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>        <span class="co"># test accuracy for current model.</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>        acc <span class="op">=</span> accuracy_score(y_val, yhat)</span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>        <span class="co"># test recall for current model</span></span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>        recall <span class="op">=</span> recall_score(y_val, yhat)</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>        <span class="co"># test precision for current model.</span></span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>        precision <span class="op">=</span> precision_score(y_val, yhat)</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>        f1 <span class="op">=</span> f1_score(y_val, yhat)</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Create list for model i with caculated information.</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>        row <span class="op">=</span> [model_name, acc, recall, precision, f1]</span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Add list as new row in model_df.</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>        model_df.loc[<span class="bu">len</span>(model_df)] <span class="op">=</span> row</span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Return dataframe with performance of each model.</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> model_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="load-data" class="level2">
<h2 class="anchored" data-anchor-id="load-data">Load Data</h2>
<div id="cell-23" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read data.</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'data\Adult.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="check-data-structure" class="level2">
<h2 class="anchored" data-anchor-id="check-data-structure">Check Data Structure</h2>
<div id="cell-25" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Look at first few rows of dataframe.</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">workclass</th>
<th data-quarto-table-cell-role="th">fnlwgt</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">educational-num</th>
<th data-quarto-table-cell-role="th">marital-status</th>
<th data-quarto-table-cell-role="th">occupation</th>
<th data-quarto-table-cell-role="th">relationship</th>
<th data-quarto-table-cell-role="th">race</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">capital-gain</th>
<th data-quarto-table-cell-role="th">capital-loss</th>
<th data-quarto-table-cell-role="th">hours-per-week</th>
<th data-quarto-table-cell-role="th">native-country</th>
<th data-quarto-table-cell-role="th">income</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>25</td>
<td>Private</td>
<td>226802</td>
<td>11th</td>
<td>7</td>
<td>Never-married</td>
<td>Machine-op-inspct</td>
<td>Own-child</td>
<td>Black</td>
<td>Male</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>38</td>
<td>Private</td>
<td>89814</td>
<td>HS-grad</td>
<td>9</td>
<td>Married-civ-spouse</td>
<td>Farming-fishing</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>0</td>
<td>0</td>
<td>50</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>28</td>
<td>Local-gov</td>
<td>336951</td>
<td>Assoc-acdm</td>
<td>12</td>
<td>Married-civ-spouse</td>
<td>Protective-serv</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>0</td>
<td>0</td>
<td>40</td>
<td>United-States</td>
<td>&gt;50K</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>44</td>
<td>Private</td>
<td>160323</td>
<td>Some-college</td>
<td>10</td>
<td>Married-civ-spouse</td>
<td>Machine-op-inspct</td>
<td>Husband</td>
<td>Black</td>
<td>Male</td>
<td>7688</td>
<td>0</td>
<td>40</td>
<td>United-States</td>
<td>&gt;50K</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>18</td>
<td>?</td>
<td>103497</td>
<td>Some-college</td>
<td>10</td>
<td>Never-married</td>
<td>?</td>
<td>Own-child</td>
<td>White</td>
<td>Female</td>
<td>0</td>
<td>0</td>
<td>30</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="cell-26" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check shape of data.</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>df.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>(48842, 15)</code></pre>
</div>
</div>
<div id="cell-27" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check data type of each column.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Data type of each column of Dataframe :'</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>df.dtypes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data type of each column of Dataframe :</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>age                 int64
workclass          object
fnlwgt              int64
education          object
educational-num     int64
marital-status     object
occupation         object
relationship       object
race               object
gender             object
capital-gain        int64
capital-loss        int64
hours-per-week      int64
native-country     object
income             object
dtype: object</code></pre>
</div>
</div>
<div id="cell-28" class="cell" data-scrolled="true" data-execution_count="14">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summary statistics.</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>df.describe(include <span class="op">=</span> <span class="st">'all'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">workclass</th>
<th data-quarto-table-cell-role="th">fnlwgt</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">educational-num</th>
<th data-quarto-table-cell-role="th">marital-status</th>
<th data-quarto-table-cell-role="th">occupation</th>
<th data-quarto-table-cell-role="th">relationship</th>
<th data-quarto-table-cell-role="th">race</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">capital-gain</th>
<th data-quarto-table-cell-role="th">capital-loss</th>
<th data-quarto-table-cell-role="th">hours-per-week</th>
<th data-quarto-table-cell-role="th">native-country</th>
<th data-quarto-table-cell-role="th">income</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>48842.000000</td>
<td>48842</td>
<td>4.884200e+04</td>
<td>48842</td>
<td>48842.000000</td>
<td>48842</td>
<td>48842</td>
<td>48842</td>
<td>48842</td>
<td>48842</td>
<td>48842.000000</td>
<td>48842.000000</td>
<td>48842.000000</td>
<td>48842</td>
<td>48842</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">unique</td>
<td>NaN</td>
<td>9</td>
<td>NaN</td>
<td>16</td>
<td>NaN</td>
<td>7</td>
<td>15</td>
<td>6</td>
<td>5</td>
<td>2</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>42</td>
<td>2</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">top</td>
<td>NaN</td>
<td>Private</td>
<td>NaN</td>
<td>HS-grad</td>
<td>NaN</td>
<td>Married-civ-spouse</td>
<td>Prof-specialty</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>United-States</td>
<td>&lt;=50K</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">freq</td>
<td>NaN</td>
<td>33906</td>
<td>NaN</td>
<td>15784</td>
<td>NaN</td>
<td>22379</td>
<td>6172</td>
<td>19716</td>
<td>41762</td>
<td>32650</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>43832</td>
<td>37155</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">mean</td>
<td>38.643585</td>
<td>NaN</td>
<td>1.896641e+05</td>
<td>NaN</td>
<td>10.078089</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>1079.067626</td>
<td>87.502314</td>
<td>40.422382</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">std</td>
<td>13.710510</td>
<td>NaN</td>
<td>1.056040e+05</td>
<td>NaN</td>
<td>2.570973</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>7452.019058</td>
<td>403.004552</td>
<td>12.391444</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">min</td>
<td>17.000000</td>
<td>NaN</td>
<td>1.228500e+04</td>
<td>NaN</td>
<td>1.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000000</td>
<td>0.000000</td>
<td>1.000000</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25%</td>
<td>28.000000</td>
<td>NaN</td>
<td>1.175505e+05</td>
<td>NaN</td>
<td>9.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000000</td>
<td>0.000000</td>
<td>40.000000</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">50%</td>
<td>37.000000</td>
<td>NaN</td>
<td>1.781445e+05</td>
<td>NaN</td>
<td>10.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000000</td>
<td>0.000000</td>
<td>40.000000</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">75%</td>
<td>48.000000</td>
<td>NaN</td>
<td>2.376420e+05</td>
<td>NaN</td>
<td>12.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>0.000000</td>
<td>0.000000</td>
<td>45.000000</td>
<td>NaN</td>
<td>NaN</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">max</td>
<td>90.000000</td>
<td>NaN</td>
<td>1.490400e+06</td>
<td>NaN</td>
<td>16.000000</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>NaN</td>
<td>99999.000000</td>
<td>4356.000000</td>
<td>99.000000</td>
<td>NaN</td>
<td>NaN</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Dashes (-) can sometimes cause problems in predictor names. Below I change all dashes to underscores.</p>
<div id="cell-30" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove '-' from column names.</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.rename(columns <span class="op">=</span> {<span class="st">'educational-num'</span>: <span class="st">'educational_num'</span>, <span class="st">'marital-status'</span>: <span class="st">'marital_status'</span>, <span class="st">'capital-gain'</span>: <span class="st">'capital_gain'</span>, <span class="st">'capital-loss'</span>: <span class="st">'capital_loss'</span>, <span class="st">'hours-per-week'</span>: <span class="st">'hours_per_week'</span>, <span class="st">'native-country'</span>: <span class="st">'native_country'</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="missing-data" class="level1">
<h1>Missing Data</h1>
<p>I always check for missing data first, and if there is missing data, the extent of its missingness will determine how I deal with it.</p>
<section id="missing-data-list" class="level2">
<h2 class="anchored" data-anchor-id="missing-data-list">Missing Data List</h2>
<div id="cell-33" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print a list of each column that has at least 1 missing value.</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'List of columns with missing values:'</span>, [col <span class="cf">for</span> col <span class="kw">in</span> df.columns <span class="cf">if</span> df[col].isnull().<span class="bu">any</span>()], <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Number of missing values per column:'</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of missing variables for each predictor, as a percentage.</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>df.isnull().mean() <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of columns with missing values: [] 

Number of missing values per column:</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>age                0.0
workclass          0.0
fnlwgt             0.0
education          0.0
educational_num    0.0
marital_status     0.0
occupation         0.0
relationship       0.0
race               0.0
gender             0.0
capital_gain       0.0
capital_loss       0.0
hours_per_week     0.0
native_country     0.0
income             0.0
dtype: float64</code></pre>
</div>
</div>
<p>Conclusion: Luck for me, there is no missing data at all (the data were likely cleaned prior to being put online).</p>
</section>
</section>
<section id="assess-predictors" class="level1">
<h1>Assess Predictors</h1>
<p>Below I’m going to simultaniously plot the data and clean it if necessary. I’ll do this in sections for each predictor. Categorical variable will go first, followed by continuous variables. ALl data will be split by the response variable (&lt;=50K, &gt;50K)</p>
<section id="workclass" class="level2">
<h2 class="anchored" data-anchor-id="workclass">Workclass</h2>
<div id="cell-37" class="cell" data-scrolled="true" data-execution_count="17">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot "workclass" labels.</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>plotPredictors(df, <span class="st">'workclass'</span>, <span class="dv">12</span>, <span class="dv">7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-18-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Some data are labelled “?”. I could deal with this in a miriad of ways. I could remove all observations, or code a new column that is 1 when that observation was missing data, and 0 otherwise. Additionally, I could replace all “?” labels with the most frequent class label. To make this more concrete, I’ll look at the percentage of the dataset containing people whose workclass is labelled “Private”, and what precentage are labelled “?”.</p>
<div id="cell-39" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display percentage of each instance in "workclass" column,</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'workclass'</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>) <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>Private             69.419762
Self-emp-not-inc     7.907129
Local-gov            6.420703
?                    5.730724
State-gov            4.055935
Self-emp-inc         3.470374
Federal-gov          2.931903
Without-pay          0.042996
Never-worked         0.020474
Name: workclass, dtype: float64</code></pre>
</div>
</div>
<p>69% of workclass are labelled “Private”, and only 5% are labelled “?”. Therefore, I’m going to change all instances of “?” to “Private”.</p>
<div id="cell-41" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace all instances of "?" in the "worclass" column with "Private",</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'workclass'</span>] <span class="op">=</span> df[<span class="st">'workclass'</span>].<span class="bu">str</span>.replace(<span class="st">'?'</span>, <span class="st">'Private'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-42" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Replot "workclass" labels.</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>plotPredictors(df, <span class="st">'workclass'</span>, <span class="dv">12</span>, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-21-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: The majority of people in all working class categories make less than &lt;=50K, with the exception of those who are self-employed.</p>
</section>
<section id="education" class="level2">
<h2 class="anchored" data-anchor-id="education">Education</h2>
<div id="cell-45" class="cell" data-scrolled="true" data-execution_count="21">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot "education" column labels.</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>plotPredictors(df, <span class="st">'education'</span>, <span class="dv">20</span>, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-22-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: There is some data from individuals who do not have more than a preschool education, which is interesting given the minimum age of the dataset is 17. These won’t be removed, but I may look at this later on.</p>
<div id="cell-47" class="cell" data-scrolled="true" data-execution_count="22">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot "educational_num" column labels.</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>plotPredictors(df, <span class="st">'educational_num'</span>, <span class="dv">12</span>, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-23-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: This variable looks like a categorical version of “education”. Thus, it is redundent and can probably be removed.</p>
<div id="cell-49" class="cell" data-scrolled="true" data-execution_count="23">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop "educational_num" column.</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns <span class="op">=</span> [<span class="st">'educational_num'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="marital-status" class="level2">
<h2 class="anchored" data-anchor-id="marital-status">Marital-status</h2>
<div id="cell-51" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot "marital_status" column labels.</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>plotPredictors(df, <span class="st">'marital_status'</span>, <span class="dv">14</span>, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-25-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: Unsurprisingly, married people seem to be the group who make a majority of people making &gt;50K.</p>
</section>
<section id="occupation" class="level2">
<h2 class="anchored" data-anchor-id="occupation">Occupation</h2>
<div id="cell-54" class="cell" data-scrolled="true" data-execution_count="25">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot "occupation" column labels.</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>plotPredictors(df, <span class="st">'occupation'</span>, <span class="dv">18</span>, <span class="dv">12</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-26-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: Like before, some data are labelled “?”. I’ll quickly look at which labels occur in the greatest number.</p>
<div id="cell-56" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display percentage of each instance in "workclass" column,</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'occupation'</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>) <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="26">
<pre><code>Prof-specialty       12.636665
Craft-repair         12.513820
Exec-managerial      12.460587
Adm-clerical         11.488064
Sales                11.268990
Other-service        10.079440
Machine-op-inspct     6.187298
?                     5.751198
Transport-moving      4.821670
Handlers-cleaners     4.242251
Farming-fishing       3.050653
Tech-support          2.960567
Protective-serv       2.012612
Priv-house-serv       0.495475
Armed-Forces          0.030711
Name: occupation, dtype: float64</code></pre>
</div>
</div>
<p>I could randomly assign the “?” labels to the top few most represented labels, but for consistency, I will assign them all to the top label “Prof-specialty”.</p>
<div id="cell-58" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace all instances of "?" with "Prof-specialty".</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'occupation'</span>] <span class="op">=</span> df[<span class="st">'occupation'</span>].<span class="bu">str</span>.replace(<span class="st">'?'</span>, <span class="st">'Prof-speciality'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-59" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Replot "occupation" column labels.</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>plotPredictors(df, <span class="st">'occupation'</span>, <span class="dv">20</span>, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-29-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: A few groups (e.g.&nbsp;“Exec-managerial”, “Prof-specialty”) seem to make the majority of people making &gt;50K.</p>
</section>
<section id="relationship" class="level2">
<h2 class="anchored" data-anchor-id="relationship">Relationship</h2>
<div id="cell-62" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot "relationship" column labels.</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>plotPredictors(df, <span class="st">'relationship'</span>, <span class="dv">10</span>, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-30-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: While wives are much less represented (probably because the dataset has more males), they seem to be just as likely to be in either category of the response variable. However, married people in general earn more.</p>
</section>
<section id="race" class="level2">
<h2 class="anchored" data-anchor-id="race">Race</h2>
<div id="cell-65" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot "race" column labels.</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>plotPredictors(df, <span class="st">'race'</span>, <span class="dv">10</span>, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-31-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: The race “White” seems to be more likely to make &gt;50K, but they are also magnitudes more represented than any other group. For instance, “Asian-Pac-Islander” seems to make up proportionally the same amount of each response variable, but they are very underrepresented.</p>
</section>
<section id="gender" class="level2">
<h2 class="anchored" data-anchor-id="gender">Gender</h2>
<div id="cell-68" class="cell" data-scrolled="false" data-execution_count="31">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot "gender" column labels.</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>plotPredictors(df, <span class="st">'gender'</span>, <span class="dv">7</span>, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-32-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: Males are more likely to make &gt;50K than females, even accounting for their greater representation in the dataset.</p>
</section>
<section id="native-country" class="level2">
<h2 class="anchored" data-anchor-id="native-country">Native-Country</h2>
<div id="cell-71" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot "gender" column labels.</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>plotPredictors(df, <span class="st">'native_country'</span>, <span class="dv">15</span>, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-33-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>United states is so dominant, it is hard to see the other groups. I should remove the United States to see the others better.</p>
<div id="cell-73" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove United-States from graph.</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df[df[<span class="st">'native_country'</span>] <span class="op">!=</span> <span class="st">'United-States'</span>]</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot "gender" column labels.</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>plotPredictors(df2, <span class="st">'native_country'</span>, <span class="dv">15</span>, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-34-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Note that the order of colors for the response variable has been flipped now (I won’t correct this because it will only affect this graph). It appears that no “native_country” group dominates the &gt;50K label. However, some data are labelled “?”. I should see how they are represented compared to the other groups.</p>
<div id="cell-75" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display percentage of each instance in "workclass" column,</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'native_country'</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>) <span class="op">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>United-States                 89.742435
Mexico                         1.947095
?                              1.754637
Philippines                    0.603988
Germany                        0.421768
Puerto-Rico                    0.376725
Canada                         0.372630
El-Salvador                    0.317350
India                          0.309160
Cuba                           0.282544
England                        0.260022
China                          0.249785
South                          0.235453
Jamaica                        0.217026
Italy                          0.214979
Dominican-Republic             0.210884
Japan                          0.188362
Guatemala                      0.180173
Poland                         0.178125
Vietnam                        0.176078
Columbia                       0.174031
Haiti                          0.153556
Portugal                       0.137177
Taiwan                         0.133082
Iran                           0.120798
Nicaragua                      0.100323
Greece                         0.100323
Peru                           0.094181
Ecuador                        0.092134
France                         0.077802
Ireland                        0.075754
Hong                           0.061423
Thailand                       0.061423
Cambodia                       0.057328
Trinadad&amp;Tobago                0.055280
Laos                           0.047091
Yugoslavia                     0.047091
Outlying-US(Guam-USVI-etc)     0.047091
Scotland                       0.042996
Honduras                       0.040948
Hungary                        0.038901
Holand-Netherlands             0.002047
Name: native_country, dtype: float64</code></pre>
</div>
</div>
<p>1.7% of respondents have “?” as a country. Since the United States covers 89% of respondents native countries, I will replace all “?” with “United-States”. Additionally, 1.75% of respondents are listed as being from “Inited-States”. They will all be changed to “United-States” as well.</p>
<div id="cell-77" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace all instances of "?" in the "worclass" column with "Private".</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'native_country'</span>] <span class="op">=</span> df[<span class="st">'native_country'</span>].<span class="bu">str</span>.replace(<span class="st">'?'</span>,<span class="st">'United-States'</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace all instances of "Inited-States" in the "worclass" column with "United-States".</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'native_country'</span>] <span class="op">=</span> df[<span class="st">'native_country'</span>].<span class="bu">str</span>.replace(<span class="st">'Inited-States'</span>,<span class="st">'United-States'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-78" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove United-States from graph.</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>df2 <span class="op">=</span> df[df[<span class="st">'native_country'</span>] <span class="op">!=</span> <span class="st">'United-States'</span>]</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot "gender" column labels.</span></span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>plotPredictors(df2, <span class="st">'native_country'</span>, <span class="dv">15</span>, <span class="dv">8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-37-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: No group is more likely to make &gt;50K, but groups like Guatemala are far more likely to make &gt;50K.</p>
</section>
<section id="capital-gaincapital-loss" class="level2">
<h2 class="anchored" data-anchor-id="capital-gaincapital-loss">Capital-Gain/Capital-Loss</h2>
<div id="cell-81" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot Capital-Gains/Captial-Loss graph.</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>sns.scatterplot(data <span class="op">=</span> df, x <span class="op">=</span> <span class="st">'capital_gain'</span>, y <span class="op">=</span> <span class="st">'capital_loss'</span>, hue <span class="op">=</span> <span class="st">'income'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-38-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: When people have zero capital gain, they have large capital-loss, and vis-versa. Perhaps these can be combined into a “capital-diff” difference score variable.</p>
<div id="cell-83" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make column "capital_diff" by taking the difference between "capital_gain" and "capital_loss".</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'capital_diff'</span>] <span class="op">=</span> df[<span class="st">'capital_loss'</span>] <span class="op">-</span> df[<span class="st">'capital_gain'</span>]</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop columns "capital_gain" and "capital_loss".</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns <span class="op">=</span> [<span class="st">'capital_gain'</span>, <span class="st">'capital_loss'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="age" class="level2">
<h2 class="anchored" data-anchor-id="age">Age</h2>
<div id="cell-85" class="cell" data-scrolled="false" data-execution_count="39">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make indicator for "income" plot.</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> df[<span class="st">'income'</span>] <span class="op">==</span> <span class="st">'&lt;=50K'</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data by indicator.</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.distplot(df[mask].age, label <span class="op">=</span> <span class="st">'&lt;=50K'</span>)</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.distplot(df[<span class="op">~</span>mask].age,label <span class="op">=</span> <span class="st">'&gt;50K'</span>)</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend.</span></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>ax.legend()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-40-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: People making &lt;=50K are skewed towards being younger, however, these proportions become almost identical once people reach retirement.</p>
<div id="cell-87" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display box and whisker plot for "age" column.</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'age'</span>].plot(kind <span class="op">=</span> <span class="st">'box'</span>)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plot.</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-41-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: Their appear to be some outliers, but that’s fine here. However, looking at the previous summary, the youngest person in the dataset is 17, yet there are people whose education stops at preschool. How is that possible? I’m going to seguay into a look at this here.</p>
<div id="cell-89" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print minimum age.</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The minimum age is:'</span>, df[<span class="st">'age'</span>].<span class="bu">min</span>(), <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print list of people with preschool-only education.</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'List of people with Preschool education: </span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>df.loc[df[<span class="st">'education'</span>] <span class="op">==</span> <span class="st">'Preschool'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The minimum age is: 17 

List of people with Preschool education: 
</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="41">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">workclass</th>
<th data-quarto-table-cell-role="th">fnlwgt</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">marital_status</th>
<th data-quarto-table-cell-role="th">occupation</th>
<th data-quarto-table-cell-role="th">relationship</th>
<th data-quarto-table-cell-role="th">race</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">hours_per_week</th>
<th data-quarto-table-cell-role="th">native_country</th>
<th data-quarto-table-cell-role="th">income</th>
<th data-quarto-table-cell-role="th">capital_diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">779</td>
<td>64</td>
<td>Private</td>
<td>86837</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Handlers-cleaners</td>
<td>Husband</td>
<td>Asian-Pac-Islander</td>
<td>Male</td>
<td>40</td>
<td>Philippines</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">818</td>
<td>21</td>
<td>Private</td>
<td>243368</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Farming-fishing</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>25</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1029</td>
<td>57</td>
<td>Private</td>
<td>274680</td>
<td>Preschool</td>
<td>Separated</td>
<td>Prof-speciality</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1059</td>
<td>31</td>
<td>Private</td>
<td>25610</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Handlers-cleaners</td>
<td>Not-in-family</td>
<td>Amer-Indian-Eskimo</td>
<td>Male</td>
<td>25</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">1489</td>
<td>19</td>
<td>Private</td>
<td>277695</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Farming-fishing</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>36</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1498</td>
<td>37</td>
<td>Self-emp-not-inc</td>
<td>227253</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Sales</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>30</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2364</td>
<td>21</td>
<td>Private</td>
<td>436431</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Prof-speciality</td>
<td>Other-relative</td>
<td>White</td>
<td>Female</td>
<td>40</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">2465</td>
<td>24</td>
<td>Private</td>
<td>403107</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Adm-clerical</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">3037</td>
<td>54</td>
<td>Private</td>
<td>99208</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Prof-speciality</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>16</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3540</td>
<td>29</td>
<td>Private</td>
<td>565769</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Prof-speciality</td>
<td>Not-in-family</td>
<td>Black</td>
<td>Male</td>
<td>40</td>
<td>South</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4426</td>
<td>30</td>
<td>Private</td>
<td>408328</td>
<td>Preschool</td>
<td>Married-spouse-absent</td>
<td>Handlers-cleaners</td>
<td>Unmarried</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">4629</td>
<td>28</td>
<td>Private</td>
<td>203784</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Farming-fishing</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>38</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4729</td>
<td>50</td>
<td>Private</td>
<td>176773</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Farming-fishing</td>
<td>Husband</td>
<td>Black</td>
<td>Male</td>
<td>40</td>
<td>Haiti</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5795</td>
<td>22</td>
<td>Private</td>
<td>267412</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Other-service</td>
<td>Own-child</td>
<td>Black</td>
<td>Female</td>
<td>20</td>
<td>Jamaica</td>
<td>&lt;=50K</td>
<td>-594</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7054</td>
<td>77</td>
<td>Self-emp-not-inc</td>
<td>161552</td>
<td>Preschool</td>
<td>Widowed</td>
<td>Exec-managerial</td>
<td>Not-in-family</td>
<td>White</td>
<td>Female</td>
<td>60</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7307</td>
<td>60</td>
<td>Self-emp-not-inc</td>
<td>269485</td>
<td>Preschool</td>
<td>Divorced</td>
<td>Other-service</td>
<td>Unmarried</td>
<td>White</td>
<td>Female</td>
<td>40</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7438</td>
<td>61</td>
<td>Self-emp-not-inc</td>
<td>243019</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Craft-repair</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7485</td>
<td>37</td>
<td>Private</td>
<td>216845</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Farming-fishing</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">7736</td>
<td>30</td>
<td>Private</td>
<td>90308</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Other-service</td>
<td>Unmarried</td>
<td>White</td>
<td>Male</td>
<td>28</td>
<td>El-Salvador</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">7773</td>
<td>19</td>
<td>Private</td>
<td>277695</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Farming-fishing</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>50</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10304</td>
<td>50</td>
<td>Private</td>
<td>330543</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Other-service</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10721</td>
<td>47</td>
<td>Private</td>
<td>98044</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Other-service</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>25</td>
<td>El-Salvador</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">10777</td>
<td>53</td>
<td>Private</td>
<td>308082</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Other-service</td>
<td>Not-in-family</td>
<td>White</td>
<td>Female</td>
<td>15</td>
<td>El-Salvador</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">10954</td>
<td>33</td>
<td>Private</td>
<td>295591</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Farming-fishing</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">11456</td>
<td>50</td>
<td>Private</td>
<td>193081</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Other-service</td>
<td>Not-in-family</td>
<td>Black</td>
<td>Female</td>
<td>40</td>
<td>Haiti</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">11677</td>
<td>47</td>
<td>Private</td>
<td>235431</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Sales</td>
<td>Unmarried</td>
<td>Black</td>
<td>Female</td>
<td>40</td>
<td>Haiti</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">13568</td>
<td>51</td>
<td>Private</td>
<td>186299</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Machine-op-inspct</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>30</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">13582</td>
<td>43</td>
<td>Self-emp-not-inc</td>
<td>245056</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Transport-moving</td>
<td>Husband</td>
<td>Black</td>
<td>Male</td>
<td>40</td>
<td>Haiti</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">14153</td>
<td>21</td>
<td>Private</td>
<td>243368</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Farming-fishing</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>50</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15513</td>
<td>35</td>
<td>Private</td>
<td>290498</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Craft-repair</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>38</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">15654</td>
<td>60</td>
<td>Private</td>
<td>225894</td>
<td>Preschool</td>
<td>Widowed</td>
<td>Prof-speciality</td>
<td>Not-in-family</td>
<td>White</td>
<td>Female</td>
<td>40</td>
<td>Guatemala</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">15964</td>
<td>61</td>
<td>Private</td>
<td>194804</td>
<td>Preschool</td>
<td>Separated</td>
<td>Transport-moving</td>
<td>Not-in-family</td>
<td>Black</td>
<td>Male</td>
<td>40</td>
<td>United-States</td>
<td>&gt;50K</td>
<td>-14344</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">16505</td>
<td>53</td>
<td>Local-gov</td>
<td>140359</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Machine-op-inspct</td>
<td>Not-in-family</td>
<td>White</td>
<td>Female</td>
<td>35</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">17213</td>
<td>51</td>
<td>Local-gov</td>
<td>241843</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Other-service</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19165</td>
<td>71</td>
<td>Private</td>
<td>235079</td>
<td>Preschool</td>
<td>Widowed</td>
<td>Craft-repair</td>
<td>Unmarried</td>
<td>Black</td>
<td>Male</td>
<td>10</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19227</td>
<td>31</td>
<td>Private</td>
<td>452405</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Other-service</td>
<td>Other-relative</td>
<td>White</td>
<td>Female</td>
<td>35</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">19727</td>
<td>33</td>
<td>Private</td>
<td>239781</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Farming-fishing</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">19873</td>
<td>39</td>
<td>Private</td>
<td>362685</td>
<td>Preschool</td>
<td>Widowed</td>
<td>Prof-speciality</td>
<td>Not-in-family</td>
<td>White</td>
<td>Female</td>
<td>20</td>
<td>El-Salvador</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">20388</td>
<td>52</td>
<td>Private</td>
<td>416129</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Other-service</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>El-Salvador</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">22714</td>
<td>27</td>
<td>Private</td>
<td>211032</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Farming-fishing</td>
<td>Other-relative</td>
<td>White</td>
<td>Male</td>
<td>24</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>-41310</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23145</td>
<td>54</td>
<td>Private</td>
<td>286989</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Farming-fishing</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>60</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">23351</td>
<td>30</td>
<td>Private</td>
<td>193598</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Farming-fishing</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">23454</td>
<td>64</td>
<td>Private</td>
<td>140237</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Prof-speciality</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24175</td>
<td>26</td>
<td>Private</td>
<td>322614</td>
<td>Preschool</td>
<td>Married-spouse-absent</td>
<td>Machine-op-inspct</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>1719</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24361</td>
<td>21</td>
<td>Private</td>
<td>243368</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Farming-fishing</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>50</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">24369</td>
<td>54</td>
<td>Private</td>
<td>148657</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Prof-speciality</td>
<td>Wife</td>
<td>White</td>
<td>Female</td>
<td>40</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">24377</td>
<td>52</td>
<td>Private</td>
<td>248113</td>
<td>Preschool</td>
<td>Married-spouse-absent</td>
<td>Prof-speciality</td>
<td>Other-relative</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">25056</td>
<td>20</td>
<td>Private</td>
<td>277700</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Other-service</td>
<td>Own-child</td>
<td>White</td>
<td>Male</td>
<td>32</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">26591</td>
<td>59</td>
<td>Private</td>
<td>157305</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Machine-op-inspct</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>Dominican-Republic</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">27415</td>
<td>32</td>
<td>Private</td>
<td>112137</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Machine-op-inspct</td>
<td>Wife</td>
<td>Asian-Pac-Islander</td>
<td>Female</td>
<td>40</td>
<td>Cambodia</td>
<td>&lt;=50K</td>
<td>-4508</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">27641</td>
<td>53</td>
<td>Private</td>
<td>188644</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Other-service</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">28015</td>
<td>65</td>
<td>Private</td>
<td>293385</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Prof-speciality</td>
<td>Husband</td>
<td>Black</td>
<td>Male</td>
<td>30</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">29529</td>
<td>68</td>
<td>Private</td>
<td>168794</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Machine-op-inspct</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>10</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">31340</td>
<td>21</td>
<td>Private</td>
<td>243368</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Farming-fishing</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>50</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">32778</td>
<td>75</td>
<td>Private</td>
<td>71898</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Priv-house-serv</td>
<td>Not-in-family</td>
<td>Asian-Pac-Islander</td>
<td>Female</td>
<td>48</td>
<td>Philippines</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">32843</td>
<td>46</td>
<td>Private</td>
<td>225065</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Machine-op-inspct</td>
<td>Wife</td>
<td>White</td>
<td>Female</td>
<td>40</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">34696</td>
<td>24</td>
<td>Private</td>
<td>243368</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Farming-fishing</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>36</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">36721</td>
<td>63</td>
<td>Private</td>
<td>440607</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Prof-specialty</td>
<td>Husband</td>
<td>Other</td>
<td>Male</td>
<td>30</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">37651</td>
<td>61</td>
<td>Private</td>
<td>98350</td>
<td>Preschool</td>
<td>Married-spouse-absent</td>
<td>Other-service</td>
<td>Not-in-family</td>
<td>Asian-Pac-Islander</td>
<td>Male</td>
<td>40</td>
<td>China</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">37669</td>
<td>24</td>
<td>Private</td>
<td>196678</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Machine-op-inspct</td>
<td>Own-child</td>
<td>White</td>
<td>Female</td>
<td>30</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38003</td>
<td>49</td>
<td>Private</td>
<td>149809</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Other-service</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">38075</td>
<td>41</td>
<td>Local-gov</td>
<td>160893</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Handlers-cleaners</td>
<td>Own-child</td>
<td>White</td>
<td>Female</td>
<td>30</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">38448</td>
<td>39</td>
<td>Private</td>
<td>341741</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Other-service</td>
<td>Not-in-family</td>
<td>White</td>
<td>Female</td>
<td>12</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">38812</td>
<td>40</td>
<td>Private</td>
<td>182268</td>
<td>Preschool</td>
<td>Married-spouse-absent</td>
<td>Adm-clerical</td>
<td>Own-child</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">39221</td>
<td>25</td>
<td>Private</td>
<td>266820</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Farming-fishing</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>35</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">40456</td>
<td>54</td>
<td>Private</td>
<td>349340</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Craft-repair</td>
<td>Husband</td>
<td>Asian-Pac-Islander</td>
<td>Male</td>
<td>40</td>
<td>India</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">40839</td>
<td>42</td>
<td>Private</td>
<td>572751</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Craft-repair</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>Nicaragua</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">40979</td>
<td>32</td>
<td>Private</td>
<td>223212</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Machine-op-inspct</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">41381</td>
<td>48</td>
<td>Private</td>
<td>209182</td>
<td>Preschool</td>
<td>Separated</td>
<td>Other-service</td>
<td>Unmarried</td>
<td>White</td>
<td>Female</td>
<td>40</td>
<td>El-Salvador</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">41394</td>
<td>23</td>
<td>Private</td>
<td>69911</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Other-service</td>
<td>Own-child</td>
<td>White</td>
<td>Female</td>
<td>15</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">41508</td>
<td>23</td>
<td>Private</td>
<td>240049</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Other-service</td>
<td>Not-in-family</td>
<td>Asian-Pac-Islander</td>
<td>Female</td>
<td>40</td>
<td>Laos</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">41933</td>
<td>42</td>
<td>Private</td>
<td>144995</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Handlers-cleaners</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>25</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42224</td>
<td>19</td>
<td>Private</td>
<td>277695</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Farming-fishing</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>36</td>
<td>Hong</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">42782</td>
<td>52</td>
<td>Private</td>
<td>370552</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Machine-op-inspct</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>El-Salvador</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">42887</td>
<td>54</td>
<td>Private</td>
<td>175262</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Craft-repair</td>
<td>Husband</td>
<td>Asian-Pac-Islander</td>
<td>Male</td>
<td>40</td>
<td>China</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">43433</td>
<td>66</td>
<td>Private</td>
<td>236879</td>
<td>Preschool</td>
<td>Widowed</td>
<td>Priv-house-serv</td>
<td>Other-relative</td>
<td>White</td>
<td>Female</td>
<td>40</td>
<td>Guatemala</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">43520</td>
<td>34</td>
<td>Local-gov</td>
<td>144182</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Adm-clerical</td>
<td>Own-child</td>
<td>Black</td>
<td>Female</td>
<td>25</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">44676</td>
<td>36</td>
<td>Private</td>
<td>252231</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Machine-op-inspct</td>
<td>Not-in-family</td>
<td>Black</td>
<td>Male</td>
<td>40</td>
<td>Puerto-Rico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">48079</td>
<td>31</td>
<td>State-gov</td>
<td>77634</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Other-service</td>
<td>Not-in-family</td>
<td>White</td>
<td>Male</td>
<td>24</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">48316</td>
<td>40</td>
<td>Private</td>
<td>566537</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Other-service</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>40</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>1672</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">48505</td>
<td>40</td>
<td>Private</td>
<td>70645</td>
<td>Preschool</td>
<td>Never-married</td>
<td>Other-service</td>
<td>Not-in-family</td>
<td>White</td>
<td>Female</td>
<td>20</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">48640</td>
<td>46</td>
<td>Private</td>
<td>139514</td>
<td>Preschool</td>
<td>Married-civ-spouse</td>
<td>Machine-op-inspct</td>
<td>Other-relative</td>
<td>Black</td>
<td>Male</td>
<td>75</td>
<td>Dominican-Republic</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">48713</td>
<td>36</td>
<td>Private</td>
<td>208068</td>
<td>Preschool</td>
<td>Divorced</td>
<td>Other-service</td>
<td>Not-in-family</td>
<td>Other</td>
<td>Male</td>
<td>72</td>
<td>Mexico</td>
<td>&lt;=50K</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>People with only a pre-school education don’t seem to have any obvious trends. It is definitely possible for for someone in the United States to never go to school as a kid/teenager (I looked it up), so this seems entirely possible and I will keep them in the dataset.</p>
</section>
<section id="hours-per-week" class="level2">
<h2 class="anchored" data-anchor-id="hours-per-week">Hours-per-week</h2>
<div id="cell-92" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make indicator for "income" plot.</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> df[<span class="st">'income'</span>] <span class="op">==</span> <span class="st">'&lt;=50K'</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data by indicator.</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.distplot(df[mask][<span class="st">'hours_per_week'</span>], label <span class="op">=</span> <span class="st">'&lt;=50K'</span>)</span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.distplot(df[<span class="op">~</span>mask][<span class="st">'hours_per_week'</span>],label <span class="op">=</span> <span class="st">'&gt;50K'</span>)</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend.</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>ax.legend()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-43-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: Most people seem to work a standard 40 hour work week. People who work less than 40 hours per week typically make &lt;=50K, while people who work more than 40 hours per week typically make &gt;50K.</p>
<div id="cell-94" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display box and whisker plots.</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'hours_per_week'</span>].plot(kind <span class="op">=</span> <span class="st">'box'</span>)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plot.</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-44-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: There are a lot’s of outliers for “hours_per_week”, but that is probably because the vast majority of people work a 40 hour workweek.</p>
</section>
<section id="capital_diff" class="level2">
<h2 class="anchored" data-anchor-id="capital_diff">Capital_diff</h2>
<div id="cell-97" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">12</span>, <span class="dv">8</span>))</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make indicator for "income" plot.</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>mask <span class="op">=</span> df[<span class="st">'income'</span>] <span class="op">==</span> <span class="st">'&lt;=50K'</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Split data by indicator.</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.distplot(df[mask][<span class="st">'capital_diff'</span>], label <span class="op">=</span> <span class="st">'&lt;=50K'</span>)</span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.distplot(df[<span class="op">~</span>mask][<span class="st">'capital_diff'</span>],label <span class="op">=</span> <span class="st">'&gt;50K'</span>)</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Add legend.</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>ax.legend()<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-45-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: If people had a change in capital gain, those making &lt;=50K were more likely to have lost money, and those making &gt;50K were more likely to have earned money.</p>
<div id="cell-99" class="cell" data-scrolled="true" data-execution_count="45">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display box and whisker plots.</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'capital_diff'</span>].plot(kind <span class="op">=</span> <span class="st">'box'</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plot.</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-46-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: Most people did not see any capital gain/loss. Therefore, any change in capital is an outlier.</p>
</section>
<section id="scaling-continuous-variables" class="level2">
<h2 class="anchored" data-anchor-id="scaling-continuous-variables">Scaling continuous variables</h2>
<p>If continuous variable are on wildly different scales, the machine learning algorithm may run into problems. I’m going to see whether this is the case for my 3 continuous predictors.</p>
<div id="cell-102" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot continuous predictors side-by-side.</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>sns.histplot(data <span class="op">=</span> df, x <span class="op">=</span> <span class="st">'age'</span>, kde <span class="op">=</span> <span class="va">True</span>, color <span class="op">=</span> <span class="st">'skyblue'</span>, ax <span class="op">=</span> axs[<span class="dv">0</span>])</span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>sns.histplot(data <span class="op">=</span> df, x <span class="op">=</span> <span class="st">'capital_diff'</span>, kde <span class="op">=</span> <span class="va">True</span>, color <span class="op">=</span> <span class="st">'gold'</span>, ax <span class="op">=</span> axs[<span class="dv">1</span>])</span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>sns.histplot(data <span class="op">=</span> df, x <span class="op">=</span> <span class="st">'hours_per_week'</span>, kde <span class="op">=</span> <span class="va">True</span>, color <span class="op">=</span> <span class="st">'teal'</span>, ax <span class="op">=</span> axs[<span class="dv">2</span>])</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plot.</span></span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-47-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: The continuous variable do not exactly fall within the same range. Standardisation will fix that.</p>
<div id="cell-104" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># List of variables I want to standardise.</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>col_names <span class="op">=</span> [<span class="st">'age'</span>, <span class="st">'capital_diff'</span>, <span class="st">'hours_per_week'</span>]</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Select variables to standardise from dataframe.</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> df[col_names]</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Set StandardScaler instance.</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>scaler <span class="op">=</span> StandardScaler().fit(features.values)</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Make array of standardised values corresponding to the columns in the dataframe.</span></span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>features <span class="op">=</span> scaler.transform(features.values)</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert standardised array to pandas dataframe.</span></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>scaled_features <span class="op">=</span> pd.DataFrame(features, columns <span class="op">=</span> col_names)</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Glimps standardised dataframe.</span></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>scaled_features.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="47">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">capital_diff</th>
<th data-quarto-table-cell-role="th">hours_per_week</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.995129</td>
<td>0.132642</td>
<td>-0.034087</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.046942</td>
<td>0.132642</td>
<td>0.772930</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.776316</td>
<td>0.132642</td>
<td>-0.034087</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.390683</td>
<td>-0.895787</td>
<td>-0.034087</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-1.505691</td>
<td>0.132642</td>
<td>-0.841104</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now the continuous predictors appear to be on a standardised scale. I’ll plot them again to see.</p>
<div id="cell-106" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set a grey background.</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>(style <span class="op">=</span> <span class="st">'darkgrid'</span>)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>fig, axs <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize <span class="op">=</span> (<span class="dv">15</span>, <span class="dv">5</span>))</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot continuous predictors side-by-side.</span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>sns.histplot(data <span class="op">=</span> scaled_features, x <span class="op">=</span> <span class="st">'age'</span>, kde <span class="op">=</span> <span class="va">True</span>, color <span class="op">=</span> <span class="st">'skyblue'</span>, ax <span class="op">=</span> axs[<span class="dv">0</span>])</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>sns.histplot(data <span class="op">=</span> scaled_features, x <span class="op">=</span> <span class="st">'capital_diff'</span>, kde <span class="op">=</span> <span class="va">True</span>, color <span class="op">=</span> <span class="st">'gold'</span>, ax <span class="op">=</span> axs[<span class="dv">1</span>])</span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>sns.histplot(data <span class="op">=</span> scaled_features, x <span class="op">=</span> <span class="st">'hours_per_week'</span>, kde <span class="op">=</span> <span class="va">True</span>, color <span class="op">=</span> <span class="st">'teal'</span>, ax <span class="op">=</span> axs[<span class="dv">2</span>])</span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-12"><a href="#cb58-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Display plot.</span></span>
<span id="cb58-13"><a href="#cb58-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-49-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>They look standardised now, so I just need to replace the standardised values with the original values in the dataframe.</p>
<div id="cell-108" class="cell" data-execution_count="49">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replace non-standardised columns with standardised columns.</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.assign(age <span class="op">=</span> scaled_features[<span class="st">'age'</span>], capital_diff <span class="op">=</span> scaled_features[<span class="st">'capital_diff'</span>], hours_per_week <span class="op">=</span> scaled_features[<span class="st">'hours_per_week'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-109" class="cell" data-execution_count="50">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Glimps dataframe.</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="50">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">workclass</th>
<th data-quarto-table-cell-role="th">fnlwgt</th>
<th data-quarto-table-cell-role="th">education</th>
<th data-quarto-table-cell-role="th">marital_status</th>
<th data-quarto-table-cell-role="th">occupation</th>
<th data-quarto-table-cell-role="th">relationship</th>
<th data-quarto-table-cell-role="th">race</th>
<th data-quarto-table-cell-role="th">gender</th>
<th data-quarto-table-cell-role="th">hours_per_week</th>
<th data-quarto-table-cell-role="th">native_country</th>
<th data-quarto-table-cell-role="th">income</th>
<th data-quarto-table-cell-role="th">capital_diff</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.995129</td>
<td>Private</td>
<td>226802</td>
<td>11th</td>
<td>Never-married</td>
<td>Machine-op-inspct</td>
<td>Own-child</td>
<td>Black</td>
<td>Male</td>
<td>-0.034087</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0.132642</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.046942</td>
<td>Private</td>
<td>89814</td>
<td>HS-grad</td>
<td>Married-civ-spouse</td>
<td>Farming-fishing</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>0.772930</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0.132642</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.776316</td>
<td>Local-gov</td>
<td>336951</td>
<td>Assoc-acdm</td>
<td>Married-civ-spouse</td>
<td>Protective-serv</td>
<td>Husband</td>
<td>White</td>
<td>Male</td>
<td>-0.034087</td>
<td>United-States</td>
<td>&gt;50K</td>
<td>0.132642</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.390683</td>
<td>Private</td>
<td>160323</td>
<td>Some-college</td>
<td>Married-civ-spouse</td>
<td>Machine-op-inspct</td>
<td>Husband</td>
<td>Black</td>
<td>Male</td>
<td>-0.034087</td>
<td>United-States</td>
<td>&gt;50K</td>
<td>-0.895787</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-1.505691</td>
<td>Private</td>
<td>103497</td>
<td>Some-college</td>
<td>Never-married</td>
<td>Prof-speciality</td>
<td>Own-child</td>
<td>White</td>
<td>Female</td>
<td>-0.841104</td>
<td>United-States</td>
<td>&lt;=50K</td>
<td>0.132642</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="fnlwgt" class="level2">
<h2 class="anchored" data-anchor-id="fnlwgt">fnlwgt</h2>
<p>This variable is some sort of weighting unit. I want to see how many unique values it has.</p>
<div id="cell-111" class="cell" data-execution_count="51">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Display number of unique "fnlwgt" labels.</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'fnlwgt'</span>].nunique()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="51">
<pre><code>28523</code></pre>
</div>
</div>
<p>Conclusion: With so many unique labels, I’m not convinced they will be useful for machine learning, so I will drop this variable.</p>
<div id="cell-113" class="cell" data-execution_count="52">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop "fnlwgt" from dataframe.</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.drop(columns <span class="op">=</span> [<span class="st">'fnlwgt'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="final-data-tweaks" class="level1">
<h1>Final Data Tweaks</h1>
<section id="dummy-coding" class="level2">
<h2 class="anchored" data-anchor-id="dummy-coding">Dummy Coding</h2>
<p>Categorical variables need to be numerically coded for most machine-learning algorithms. However, simply giving a unique value to each label of a predictor will imply a rank to each instance (which is not the case for any of these predictors). To get around that, each predictor will be given as many columns as instances, and will be designated 1 if that observation is an instance of it, and 0 otherwise. First, I want to see which predictors actually are categorical.</p>
<div id="cell-116" class="cell" data-execution_count="53">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make list displaying whether a column is continuous or object-based.</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> (df.dtypes <span class="op">==</span> <span class="st">'object'</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Drop income, since I want to save labels with a label encoder.</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> s.drop([<span class="st">'income'</span>])</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Make list of column names with object instances.</span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>object_cols <span class="op">=</span> <span class="bu">list</span>(s[s].index)</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Print names of all columns with categorical instances.</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Categorical variables:'</span>, <span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(object_cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Categorical variables: 

['workclass', 'education', 'marital_status', 'occupation', 'relationship', 'race', 'gender', 'native_country']</code></pre>
</div>
</div>
<p>Each of these variables needs to be dummy coded.</p>
<div id="cell-118" class="cell" data-execution_count="54">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Dummy code categorical predictors. </span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat([df, pd.get_dummies(data <span class="op">=</span> df, columns <span class="op">=</span> <span class="bu">list</span>(s[s].index), drop_first <span class="op">=</span> <span class="va">True</span>)], axis <span class="op">=</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, I can remove the none-dummy coded categorical predictors.</p>
<div id="cell-120" class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove non-dummy coded object columns.</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>df.drop(object_cols, axis <span class="op">=</span> <span class="dv">1</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-121" class="cell" data-scrolled="false" data-execution_count="56">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Recheck dataframe.</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">hours_per_week</th>
<th data-quarto-table-cell-role="th">income</th>
<th data-quarto-table-cell-role="th">capital_diff</th>
<th data-quarto-table-cell-role="th">age</th>
<th data-quarto-table-cell-role="th">hours_per_week</th>
<th data-quarto-table-cell-role="th">income</th>
<th data-quarto-table-cell-role="th">capital_diff</th>
<th data-quarto-table-cell-role="th">workclass_Local-gov</th>
<th data-quarto-table-cell-role="th">workclass_Never-worked</th>
<th data-quarto-table-cell-role="th">workclass_Private</th>
<th data-quarto-table-cell-role="th">workclass_Self-emp-inc</th>
<th data-quarto-table-cell-role="th">workclass_Self-emp-not-inc</th>
<th data-quarto-table-cell-role="th">workclass_State-gov</th>
<th data-quarto-table-cell-role="th">workclass_Without-pay</th>
<th data-quarto-table-cell-role="th">education_11th</th>
<th data-quarto-table-cell-role="th">education_12th</th>
<th data-quarto-table-cell-role="th">education_1st-4th</th>
<th data-quarto-table-cell-role="th">education_5th-6th</th>
<th data-quarto-table-cell-role="th">education_7th-8th</th>
<th data-quarto-table-cell-role="th">education_9th</th>
<th data-quarto-table-cell-role="th">education_Assoc-acdm</th>
<th data-quarto-table-cell-role="th">education_Assoc-voc</th>
<th data-quarto-table-cell-role="th">education_Bachelors</th>
<th data-quarto-table-cell-role="th">education_Doctorate</th>
<th data-quarto-table-cell-role="th">education_HS-grad</th>
<th data-quarto-table-cell-role="th">education_Masters</th>
<th data-quarto-table-cell-role="th">education_Preschool</th>
<th data-quarto-table-cell-role="th">education_Prof-school</th>
<th data-quarto-table-cell-role="th">education_Some-college</th>
<th data-quarto-table-cell-role="th">marital_status_Married-AF-spouse</th>
<th data-quarto-table-cell-role="th">marital_status_Married-civ-spouse</th>
<th data-quarto-table-cell-role="th">marital_status_Married-spouse-absent</th>
<th data-quarto-table-cell-role="th">marital_status_Never-married</th>
<th data-quarto-table-cell-role="th">marital_status_Separated</th>
<th data-quarto-table-cell-role="th">marital_status_Widowed</th>
<th data-quarto-table-cell-role="th">occupation_Armed-Forces</th>
<th data-quarto-table-cell-role="th">occupation_Craft-repair</th>
<th data-quarto-table-cell-role="th">occupation_Exec-managerial</th>
<th data-quarto-table-cell-role="th">occupation_Farming-fishing</th>
<th data-quarto-table-cell-role="th">occupation_Handlers-cleaners</th>
<th data-quarto-table-cell-role="th">occupation_Machine-op-inspct</th>
<th data-quarto-table-cell-role="th">occupation_Other-service</th>
<th data-quarto-table-cell-role="th">occupation_Priv-house-serv</th>
<th data-quarto-table-cell-role="th">occupation_Prof-speciality</th>
<th data-quarto-table-cell-role="th">occupation_Prof-specialty</th>
<th data-quarto-table-cell-role="th">occupation_Protective-serv</th>
<th data-quarto-table-cell-role="th">occupation_Sales</th>
<th data-quarto-table-cell-role="th">occupation_Tech-support</th>
<th data-quarto-table-cell-role="th">occupation_Transport-moving</th>
<th data-quarto-table-cell-role="th">relationship_Not-in-family</th>
<th data-quarto-table-cell-role="th">relationship_Other-relative</th>
<th data-quarto-table-cell-role="th">relationship_Own-child</th>
<th data-quarto-table-cell-role="th">relationship_Unmarried</th>
<th data-quarto-table-cell-role="th">relationship_Wife</th>
<th data-quarto-table-cell-role="th">race_Asian-Pac-Islander</th>
<th data-quarto-table-cell-role="th">race_Black</th>
<th data-quarto-table-cell-role="th">race_Other</th>
<th data-quarto-table-cell-role="th">race_White</th>
<th data-quarto-table-cell-role="th">gender_Male</th>
<th data-quarto-table-cell-role="th">native_country_Canada</th>
<th data-quarto-table-cell-role="th">native_country_China</th>
<th data-quarto-table-cell-role="th">native_country_Columbia</th>
<th data-quarto-table-cell-role="th">native_country_Cuba</th>
<th data-quarto-table-cell-role="th">native_country_Dominican-Republic</th>
<th data-quarto-table-cell-role="th">native_country_Ecuador</th>
<th data-quarto-table-cell-role="th">native_country_El-Salvador</th>
<th data-quarto-table-cell-role="th">native_country_England</th>
<th data-quarto-table-cell-role="th">native_country_France</th>
<th data-quarto-table-cell-role="th">native_country_Germany</th>
<th data-quarto-table-cell-role="th">native_country_Greece</th>
<th data-quarto-table-cell-role="th">native_country_Guatemala</th>
<th data-quarto-table-cell-role="th">native_country_Haiti</th>
<th data-quarto-table-cell-role="th">native_country_Holand-Netherlands</th>
<th data-quarto-table-cell-role="th">native_country_Honduras</th>
<th data-quarto-table-cell-role="th">native_country_Hong</th>
<th data-quarto-table-cell-role="th">native_country_Hungary</th>
<th data-quarto-table-cell-role="th">native_country_India</th>
<th data-quarto-table-cell-role="th">native_country_Iran</th>
<th data-quarto-table-cell-role="th">native_country_Ireland</th>
<th data-quarto-table-cell-role="th">native_country_Italy</th>
<th data-quarto-table-cell-role="th">native_country_Jamaica</th>
<th data-quarto-table-cell-role="th">native_country_Japan</th>
<th data-quarto-table-cell-role="th">native_country_Laos</th>
<th data-quarto-table-cell-role="th">native_country_Mexico</th>
<th data-quarto-table-cell-role="th">native_country_Nicaragua</th>
<th data-quarto-table-cell-role="th">native_country_Outlying-US(Guam-USVI-etc)</th>
<th data-quarto-table-cell-role="th">native_country_Peru</th>
<th data-quarto-table-cell-role="th">native_country_Philippines</th>
<th data-quarto-table-cell-role="th">native_country_Poland</th>
<th data-quarto-table-cell-role="th">native_country_Portugal</th>
<th data-quarto-table-cell-role="th">native_country_Puerto-Rico</th>
<th data-quarto-table-cell-role="th">native_country_Scotland</th>
<th data-quarto-table-cell-role="th">native_country_South</th>
<th data-quarto-table-cell-role="th">native_country_Taiwan</th>
<th data-quarto-table-cell-role="th">native_country_Thailand</th>
<th data-quarto-table-cell-role="th">native_country_Trinadad&amp;Tobago</th>
<th data-quarto-table-cell-role="th">native_country_United-States</th>
<th data-quarto-table-cell-role="th">native_country_Vietnam</th>
<th data-quarto-table-cell-role="th">native_country_Yugoslavia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.995129</td>
<td>-0.034087</td>
<td>&lt;=50K</td>
<td>0.132642</td>
<td>-0.995129</td>
<td>-0.034087</td>
<td>&lt;=50K</td>
<td>0.132642</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>-0.046942</td>
<td>0.772930</td>
<td>&lt;=50K</td>
<td>0.132642</td>
<td>-0.046942</td>
<td>0.772930</td>
<td>&lt;=50K</td>
<td>0.132642</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>-0.776316</td>
<td>-0.034087</td>
<td>&gt;50K</td>
<td>0.132642</td>
<td>-0.776316</td>
<td>-0.034087</td>
<td>&gt;50K</td>
<td>0.132642</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>0.390683</td>
<td>-0.034087</td>
<td>&gt;50K</td>
<td>-0.895787</td>
<td>0.390683</td>
<td>-0.034087</td>
<td>&gt;50K</td>
<td>-0.895787</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>-1.505691</td>
<td>-0.841104</td>
<td>&lt;=50K</td>
<td>0.132642</td>
<td>-1.505691</td>
<td>-0.841104</td>
<td>&lt;=50K</td>
<td>0.132642</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Now there are far more columns than before, but they are properly coded.</p>
</section>
<section id="check-for-duplicate-columns" class="level2">
<h2 class="anchored" data-anchor-id="check-for-duplicate-columns">Check For Duplicate Columns</h2>
<p>When I change a lot of predictors in an analysis, mistakes can sometimes be made. I want to make sure no variables have been duplicated by mistake.</p>
<div id="cell-124" class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get list of duplicate columns</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>duplicateColumnNames <span class="op">=</span> getDuplicateColumns(df)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Duplicate Columns are as follows:'</span>)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop that prints contents of duplicate list.</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> duplicateColumnNames:</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Column name : '</span>, col)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Duplicate Columns are as follows:
Column name :  age
Column name :  capital_diff
Column name :  income
Column name :  hours_per_week</code></pre>
</div>
</div>
<p>Somewhere along the way, these 4 predictors were duplicated. This would be redundent information for the machine-learning algorithm, so I will remove them.</p>
<div id="cell-126" class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Remove duplicate columns.</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.loc[:, <span class="op">~</span>df.columns.duplicated()]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-127" class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get list of duplicate columns</span></span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>duplicateColumnNames <span class="op">=</span> getDuplicateColumns(df)</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Duplicate Columns are as follows:'</span>)</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Loop that prints contents of duplicate list.</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> col <span class="kw">in</span> duplicateColumnNames:</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">'Column name : '</span>, col)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Duplicate Columns are as follows:</code></pre>
</div>
</div>
<p>Now there are no duplicates, and I’, ready to prepare the machine-learning model!</p>
</section>
</section>
<section id="machine-learning-model" class="level1">
<h1>Machine Learning Model</h1>
<section id="define-predictors-and-response-variable" class="level2">
<h2 class="anchored" data-anchor-id="define-predictors-and-response-variable">Define Predictors And Response Variable</h2>
<div id="cell-131" class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define response variable.</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'income'</span>]</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Define predictor variables.</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop(columns <span class="op">=</span> <span class="st">'income'</span>)</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Define label encoder.</span></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>lab <span class="op">=</span> preprocessing.LabelEncoder()</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform response variable vector (y) to numeric.</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> lab.fit_transform(y)</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Invert numeric response variables (so that &lt;=50K is a positive class).</span></span>
<span id="cb74-14"><a href="#cb74-14" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.where((y <span class="op">==</span> <span class="dv">0</span>)<span class="op">|</span>(y <span class="op">==</span> <span class="dv">1</span>), y<span class="op">^</span><span class="dv">1</span>, y)</span>
<span id="cb74-15"><a href="#cb74-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-16"><a href="#cb74-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Print numerical y.</span></span>
<span id="cb74-17"><a href="#cb74-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Numerical y:'</span>, y)</span>
<span id="cb74-18"><a href="#cb74-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-19"><a href="#cb74-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Invert numerical y and print label.</span></span>
<span id="cb74-20"><a href="#cb74-20" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Labelled y:'</span>, lab.inverse_transform(y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Numerical y: [1 1 0 ... 1 1 0]
Labelled y: ['&gt;50K' '&gt;50K' '&lt;=50K' ... '&gt;50K' '&gt;50K' '&lt;=50K']</code></pre>
</div>
</div>
<p>A cursory glance at the first and last few response variables show that “1” = “&gt;50K” and “0” = “&lt;=50K”.</p>
</section>
<section id="define-training-validation-and-testing-sets" class="level2">
<h2 class="anchored" data-anchor-id="define-training-validation-and-testing-sets">Define Training, Validation, And Testing Sets</h2>
<p>I will add a validation set so that I can use grid search later withour contaminating the test set.</p>
<div id="cell-134" class="cell" data-execution_count="61">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Split into train/test sets.</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> model_selection.train_test_split(X, y, test_size <span class="op">=</span> <span class="fl">0.2</span>, random_state <span class="op">=</span> <span class="dv">42</span>,stratify <span class="op">=</span> y)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get validation for hyperparameter tuning.</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>X_train, X_val, y_train, y_val <span class="op">=</span> model_selection.train_test_split(X_train, y_train, test_size <span class="op">=</span> <span class="fl">0.25</span>, random_state <span class="op">=</span> <span class="dv">1</span>,stratify <span class="op">=</span> y_train)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Print size of training, validation, and testing set for verification.</span></span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'X_Train Shape ='</span>, <span class="bu">round</span>(X_train.shape[<span class="dv">0</span>]<span class="op">/</span><span class="dv">48842</span> <span class="op">*</span> <span class="dv">100</span>),<span class="st">'%'</span>)</span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'X_Validate Shape ='</span>, <span class="bu">round</span>(X_val.shape[<span class="dv">0</span>]<span class="op">/</span><span class="dv">48842</span> <span class="op">*</span> <span class="dv">100</span>),<span class="st">'%'</span>)</span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'X_Test Shape ='</span>, <span class="bu">round</span>(X_test.shape[<span class="dv">0</span>]<span class="op">/</span><span class="dv">48842</span> <span class="op">*</span> <span class="dv">100</span>),<span class="st">'%'</span>)</span>
<span id="cb76-11"><a href="#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">''</span>) <span class="co"># Add space.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>X_Train Shape = 60 %
X_Validate Shape = 20 %
X_Test Shape = 20 %
</code></pre>
</div>
</div>
</section>
<section id="testing-different-classifiers" class="level2">
<h2 class="anchored" data-anchor-id="testing-different-classifiers">Testing Different Classifiers</h2>
<p>I’ll first test a dummy classifier, which randomly guesses which class each observation belongs to. This will be a soft benchmark that all machine learning classifiers I test must pass. Then I will test a series of different classes of classifier to get a rough benchmark for each of those. From there, I will pick the best one and further tune its parameters. Of note, the function I wrote to test each classifier tests against the validation set, and not the test set. That’s because I will further assess the winning classifier and so I don’t want to double dip.</p>
<p>The classifiers I will train are: a dummy classifier (guesses), logistic regression, decision tree, k nearest neighbor, gaussian naive bayes, random forest, and xgboost.</p>
<div id="cell-136" class="cell" data-execution_count="62">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe of classifier performance using testClassifier() function.</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>testClassifiers([DummyClassifier,</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>                 LogisticRegression,</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>                 DecisionTreeClassifier,</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>                 KNeighborsClassifier,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>                 GaussianNB,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>                 RandomForestClassifier,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>                 xgboost.XGBClassifier],</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>                X_train, y_train, X_val, y_val)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[14:07:59] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="62">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Classifier</th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">f1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>DummyClassifier</td>
<td>0.760774</td>
<td>1.000000</td>
<td>0.760774</td>
<td>0.864136</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>LogisticRegression</td>
<td>0.846658</td>
<td>0.934876</td>
<td>0.872645</td>
<td>0.902689</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>DecisionTreeClassifier</td>
<td>0.819019</td>
<td>0.874058</td>
<td>0.886463</td>
<td>0.880217</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>KNeighborsClassifier</td>
<td>0.833760</td>
<td>0.913213</td>
<td>0.873938</td>
<td>0.893144</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>GaussianNB</td>
<td>0.562903</td>
<td>0.445102</td>
<td>0.957730</td>
<td>0.607753</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">5</td>
<td>RandomForestClassifier</td>
<td>0.848091</td>
<td>0.920344</td>
<td>0.884635</td>
<td>0.902137</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">6</td>
<td>XGBClassifier</td>
<td>0.869792</td>
<td>0.947390</td>
<td>0.888791</td>
<td>0.917155</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>First, total accuracy is not a good metric here. That’s because the classes are imbalanced, and so a classifier that guesses could have accuracy much higher than 50% if it guesses that every instance belongs to the most common class. Therefore, I will use the harmonic mean (aka f1) as my metric because it is a good measure for comparing classifiers. Additionally, the dummy classifier acts randomly, so it should be the benchmark such that all other classifiers should perform better than it does. Based on the above output, the xgboost classifier is both more accurate and has a higher f1 score than any other classifier. It also beats the dummy classifier.</p>
</section>
<section id="stacked-model" class="level2">
<h2 class="anchored" data-anchor-id="stacked-model">Stacked Model</h2>
<p>Stacked models combine the outputs of a bunch of previously tested models in an attempt to improve overall fit. Here I’ll take all of the previous model’s outputs and see if that can achieve better results than the xgboost algorithm.</p>
<div id="cell-139" class="cell" data-scrolled="true" data-execution_count="63">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stacked Models for simultanious stacking.</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>clfs <span class="op">=</span> [x() <span class="cf">for</span> x <span class="kw">in</span> [LogisticRegression,</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>                      DecisionTreeClassifier,</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>                      KNeighborsClassifier,</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>                      GaussianNB,</span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>                      RandomForestClassifier,</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>                      xgboost.XGBClassifier]]</span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify stacking classifier..</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>stack <span class="op">=</span> StackingClassifier(classifiers <span class="op">=</span> clfs,meta_classifier <span class="op">=</span> LogisticRegression())</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Use 10-fold cross-validation.</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>kfold <span class="op">=</span> model_selection.KFold(n_splits <span class="op">=</span> <span class="dv">10</span>)</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Get stacked model score.</span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> model_selection.cross_val_score(stack, X_train, y_train, scoring <span class="op">=</span> <span class="st">"roc_auc"</span>, cv <span class="op">=</span> kfold)</span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Print stacked model accuracy and standard deviation.</span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>stack<span class="sc">.</span>__class__<span class="sc">.</span><span class="va">__name__</span><span class="sc">}</span><span class="ss"> "</span> <span class="ss">f"AUC: </span><span class="sc">{</span>s<span class="sc">.</span>mean()<span class="sc">:.3f}</span><span class="ss"> STD: </span><span class="sc">{</span>s<span class="sc">.</span>std()<span class="sc">:.2f}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[14:09:05] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.
[14:09:36] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.
[14:10:11] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.
[14:10:47] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.
[14:11:19] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.
[14:11:55] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.
[14:12:29] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.
[14:13:02] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.
[14:13:37] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.
[14:14:12] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.
StackingClassifier AUC: 0.855 STD: 0.01</code></pre>
</div>
</div>
<p>I am only using accuracy as a metric here, but it does not seem to perform better than the xgboost classifier. Therefore, the xgboost classifier is what I will use.</p>
</section>
<section id="xgboost-base-model" class="level2">
<h2 class="anchored" data-anchor-id="xgboost-base-model">XGBoost Base Model</h2>
<p>First, I will refit the xgboost algorithm and test it using the validation set.</p>
<div id="cell-142" class="cell" data-execution_count="64">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe of classifier performance using testClassifier() function.</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>xgboost_baseline <span class="op">=</span> testClassifiers([xgboost.XGBClassifier], X_train, y_train, X_val, y_val)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Display output.</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>xgboost_baseline</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[14:29:54] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="64">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Classifier</th>
<th data-quarto-table-cell-role="th">Accuracy</th>
<th data-quarto-table-cell-role="th">Recall</th>
<th data-quarto-table-cell-role="th">Precision</th>
<th data-quarto-table-cell-role="th">f1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>XGBClassifier</td>
<td>0.869792</td>
<td>0.94739</td>
<td>0.888791</td>
<td>0.917155</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>This is the baseline output of the xgboost classifier. On the validation set, it assigned 87% of samples to the correct label. Of all the &lt;=50K samples it encountered, it correctly classified 95% of them. Finally, of all the times it classified an observation a &lt;=50K, it was correct 89% of the time. Now, I will see whether I can enhance these metrics.</p>
</section>
<section id="xgboost-grid-search" class="level2">
<h2 class="anchored" data-anchor-id="xgboost-grid-search">XGBoost Grid Search</h2>
<p>I want to run a grid search, but xgboost has a ton of parameters. In an ideal world, I could tune the model to every iteration of parameters, but here, it would take too long. Therefore I’m only going to focus on a few important parameters.</p>
<p>Below is a parameter dictionary with the parameters I want to tune:</p>
<div id="cell-145" class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter dictionary. I will update these based on the best parameters found during grid search.</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'max_depth'</span>:<span class="dv">6</span>,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'min_child_weight'</span>: <span class="dv">1</span>,</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'eta'</span>:<span class="fl">.3</span>,</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'subsample'</span>: <span class="dv">1</span>,</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'colsample_bytree'</span>: <span class="dv">1</span>,</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'objective'</span>:<span class="st">'binary:logistic'</span>,</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-146" class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tuning 'max_depth' and 'min_child_weight'.</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set first grid search model.</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>xgb_grid1 <span class="op">=</span> xgboost.XGBClassifier()</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set parameter range for grid search.</span></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {<span class="st">'max_depth'</span>: np.arange(<span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">1</span>),</span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">'min_child_weight'</span>: np.arange(<span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">1</span>)}</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit training data to all parameter combinations.</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> model_selection.GridSearchCV(xgb_grid1, params, n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>).fit(X_train, y_train)</span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Print parameters that result in highest prediction accuracy.</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cv.best_params_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[14:41:28] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.
{'max_depth': 4, 'min_child_weight': 1}</code></pre>
</div>
</div>
<div id="cell-147" class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update parameter list with gridsearch's best parameters.</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>params[<span class="st">'max_depth'</span>] <span class="op">=</span> <span class="dv">4</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>params[<span class="st">'min_child_weight'</span>] <span class="op">=</span> <span class="dv">1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-148" class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start tuning 'subsample' and 'colsample_bytree'.</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set second grid search model.</span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>xgb_grid2 <span class="op">=</span> xgboost.XGBClassifier()</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set parameter range for grid search.</span></span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {<span class="st">'subsample'</span>: np.arange(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>),</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">'colsample_bytree'</span>: np.arange(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="fl">0.1</span>)}</span>
<span id="cb88-9"><a href="#cb88-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-10"><a href="#cb88-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit training data to all parameter combinations.</span></span>
<span id="cb88-11"><a href="#cb88-11" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> model_selection.GridSearchCV(xgb_grid1, params, n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>).fit(X_train, y_train)</span>
<span id="cb88-12"><a href="#cb88-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-13"><a href="#cb88-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Print parameters that result in highest prediction accuracy.</span></span>
<span id="cb88-14"><a href="#cb88-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cv.best_params_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[14:51:22] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.
{'colsample_bytree': 0.2, 'subsample': 0.8}</code></pre>
</div>
</div>
<div id="cell-149" class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update parameter list with gridsearch's best parameters.</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>params[<span class="st">'subsample'</span>] <span class="op">=</span> <span class="fl">0.8</span></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>params[<span class="st">'colsample_bytree'</span>] <span class="op">=</span> <span class="fl">0.2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-150" class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Start tuning 'eta'.</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Set second grid search model.</span></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>xgb_grid3 <span class="op">=</span> xgboost.XGBClassifier()</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Set parameter range for grid search.</span></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>params <span class="op">=</span> {<span class="st">'eta'</span>: [<span class="fl">.3</span>, <span class="fl">.2</span>, <span class="fl">.1</span>, <span class="fl">.05</span>, <span class="fl">.01</span>, <span class="fl">.005</span>]}</span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit training data to all parameter combinations.</span></span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> model_selection.GridSearchCV(xgb_grid3, params, n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>).fit(X_train, y_train)</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Print parameters that result in highest prediction accuracy.</span></span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cv.best_params_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[14:52:40] WARNING: C:/Users/Administrator/workspace/xgboost-win64_release_1.4.0/src/learner.cc:1095: Starting in XGBoost 1.3.0, the default evaluation metric used with the objective 'binary:logistic' was changed from 'error' to 'logloss'. Explicitly set eval_metric if you'd like to restore the old behavior.
{'eta': 0.1}</code></pre>
</div>
</div>
<div id="cell-151" class="cell" data-execution_count="71">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Update parameter list with gridsearch's best parameter.</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>params[<span class="st">'eta'</span>] <span class="op">=</span> <span class="fl">0.1</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-152" class="cell" data-execution_count="72">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot validation set accuracy.</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>xgb_class.score(X_test, y_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg ansi-bold">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg ansi-bold">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg ansi-bold">&lt;ipython-input-72-0b1ae4b17fcb&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">      1</span> <span class="ansi-red-fg ansi-bold"># Plot validation set accuracy.</span>
<span class="ansi-green-fg ansi-bold">----&gt; 2</span><span class="ansi-yellow-fg ansi-bold"> </span>xgb_class<span class="ansi-yellow-fg ansi-bold">.</span>score<span class="ansi-yellow-fg ansi-bold">(</span>X_test<span class="ansi-yellow-fg ansi-bold">,</span> y_test<span class="ansi-yellow-fg ansi-bold">)</span>

<span class="ansi-red-fg ansi-bold">NameError</span>: name 'xgb_class' is not defined</pre>
</div>
</div>
</div>
<div id="cell-153" class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>xgboost_mod <span class="op">=</span> testxgboost([xgboost.XGBClassifier],</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>                X_train, y_train, X_val, y_val)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="cell-154" class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'xgboost baseline'</span>)</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(xgboost_baseline)</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">''</span>)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'xgboost grid search'</span>)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(xgboost_mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Conclusion: While the gridsearch identified different parameter values than those selected by the inital model fit, their combined effect does not enhance or detract the total accuracy.</p>
<div id="cell-156" class="cell" data-execution_count="79">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change xgboost handle.</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> xgboost <span class="im">as</span> xgb</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify xgboost classifier.</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>xgb_class <span class="op">=</span> xgb.XGBClassifier(random_state <span class="op">=</span> <span class="dv">42</span>,</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>                              eta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>                              ubsample <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a>                              colsample_bytree <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a>                              max_depth <span class="op">=</span> <span class="dv">4</span>,</span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a>                              min_child_weight <span class="op">=</span> <span class="dv">2</span>,</span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a>                             use_label_encoder <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit xgboost model.</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a>xgb_class.fit(X_train, y_train, early_stopping_rounds <span class="op">=</span> <span class="dv">10</span>, eval_set <span class="op">=</span> [(X_val, y_val)], verbose <span class="op">=</span> <span class="va">False</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="79">
<pre><code>XGBClassifier(base_score=0.5, booster='gbtree', colsample_bylevel=1,
              colsample_bynode=1, colsample_bytree=0.3, eta=0.2, gamma=0,
              gpu_id=-1, importance_type='gain', interaction_constraints='',
              learning_rate=0.200000003, max_delta_step=0, max_depth=4,
              min_child_weight=2, missing=nan, monotone_constraints='()',
              n_estimators=100, n_jobs=8, num_parallel_tree=1, random_state=42,
              reg_alpha=0, reg_lambda=1, scale_pos_weight=1, subsample=1,
              tree_method='exact', ubsample=0.8, use_label_encoder=False,
              validate_parameters=1, verbosity=None)</code></pre>
</div>
</div>
</section>
</section>
<section id="model-evaluation" class="level1">
<h1>Model Evaluation</h1>
<section id="validation-curve" class="level2">
<h2 class="anchored" data-anchor-id="validation-curve">Validation Curve</h2>
<p>The validation curve can help show how different parameter levels affect classification accuracy. As an example, I will look at one of the more important parameters “max_depth”.</p>
<div id="cell-159" class="cell" data-execution_count="80">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Validation curve specificaions.</span></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>vc_viz <span class="op">=</span> ValidationCurve(xgboost.XGBClassifier(verbosity <span class="op">=</span> <span class="dv">0</span>),</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>                         param_name <span class="op">=</span> <span class="st">'max_depth'</span>,</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>                         param_range <span class="op">=</span> np.arange(<span class="dv">1</span>, <span class="dv">11</span>),</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>                         cv <span class="op">=</span> <span class="dv">10</span>,</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>                         scoring <span class="op">=</span> <span class="st">'accuracy'</span>,</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>                         n_jobs <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Run validation curve.</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>vc_viz.fit(X_test, y_test)</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot validation curve.</span></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>vc_viz.poof()<span class="op">;</span></span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Save validation curve plot.</span></span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">'images/ValidationCurve.png'</span>, dpi <span class="op">=</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-77-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: The cross-validation score is what I want to maximize here. It looks like a max tree depth of 2 or 3 would be optimal, altohugh it doesn’t really change the overall model accuracy. Max depth was tuned to 4 by the xgboost I used, but that still looks good based on the curve.</p>
</section>
<section id="learning-curve" class="level2">
<h2 class="anchored" data-anchor-id="learning-curve">Learning Curve</h2>
<p>This can show a number of things. First, it can indicate whether more data should be collected, and it can be informative as to whether the model is overfitting or underfitting to the data.</p>
<div id="cell-162" class="cell" data-scrolled="false" data-execution_count="81">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Learning curve specificaions.</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>lc3_viz <span class="op">=</span> LearningCurve(xgboost.XGBClassifier(n_estimators <span class="op">=</span> <span class="dv">100</span>), cv <span class="op">=</span> <span class="dv">10</span>)</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Run learning curve.</span></span>
<span id="cb100-8"><a href="#cb100-8" aria-hidden="true" tabindex="-1"></a>lc3_viz.fit(X_test, y_test)</span>
<span id="cb100-9"><a href="#cb100-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-10"><a href="#cb100-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot learning curve.</span></span>
<span id="cb100-11"><a href="#cb100-11" aria-hidden="true" tabindex="-1"></a>lc3_viz.poof()<span class="op">;</span></span>
<span id="cb100-12"><a href="#cb100-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-13"><a href="#cb100-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Save learning curve plot.</span></span>
<span id="cb100-14"><a href="#cb100-14" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">'images/LearningCurve.png'</span>, dpi <span class="op">=</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-78-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: First, it looks like collecting more data would lead to very mediocre improvements to the cross-validation score: it has essentially plateued. There is very little variability in the training score (the “cloud” around the line) so I know the model is not biased (i.e.&nbsp;no underfitting). There is some variability in the cross-validation score, indicating that the model may have some variance (i.e.&nbsp;some overfitting). Regularisation can sometimes be applied to reduce overfitting, but here I think this model looks decent.</p>
</section>
</section>
<section id="metrics-and-classification-evaluation" class="level1">
<h1>Metrics And Classification Evaluation</h1>
<section id="confusion-matrix" class="level2">
<h2 class="anchored" data-anchor-id="confusion-matrix">Confusion Matrix</h2>
<p>The confusion matrix will give me a lot of important information related to accuacy, recall, and precision.</p>
<div id="cell-166" class="cell" data-execution_count="82">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix specificaions.</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>cm_viz <span class="op">=</span> ConfusionMatrix(xgb_class, classes <span class="op">=</span> [<span class="st">'&gt;50K'</span>, <span class="st">'&lt;=50K'</span>], label_encoder <span class="op">=</span> {<span class="dv">0</span>: <span class="st">'&gt;50K'</span>, <span class="dv">1</span>: <span class="st">'&lt;=50K'</span>})</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get confusion matrix score.</span></span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>cm_viz.score(X_test, y_test)</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot confusion matrix.</span></span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>cm_viz.poof()<span class="op">;</span></span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Save confusion matrix plot.</span></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">'images/ConfusionMatrix.png'</span>, dpi <span class="op">=</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-79-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: Since I defined &lt;=50K as being the positive class, I will consider the bottom right corner to be true positives, and the top left corner to be true negatives.</p>
<div id="cell-168" class="cell" data-execution_count="83">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining true positives (tp), false positives (fp), false negatives (fn), and true negatives (tn).</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>tp <span class="op">=</span> <span class="dv">7028</span></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>fp <span class="op">=</span> <span class="dv">854</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>fn <span class="op">=</span> <span class="dv">403</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>tn <span class="op">=</span> <span class="dv">1484</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="accuracy" class="level2">
<h2 class="anchored" data-anchor-id="accuracy">Accuracy</h2>
<p>First, Let’s see, overall, how well the classifier correctly predicts positive and negative classes.</p>
<section id="manual-calculation" class="level3">
<h3 class="anchored" data-anchor-id="manual-calculation">Manual Calculation</h3>
<div id="cell-171" class="cell" data-execution_count="84">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually calculate accuracy.</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>(tp <span class="op">+</span> tn)<span class="op">/</span>(tp <span class="op">+</span> fp <span class="op">+</span> fn <span class="op">+</span> tn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="84">
<pre><code>0.8713276691575391</code></pre>
</div>
</div>
</section>
<section id="scikitlearn-calculation" class="level3">
<h3 class="anchored" data-anchor-id="scikitlearn-calculation">ScikitLearn Calculation</h3>
<div id="cell-173" class="cell" data-execution_count="85">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on test set.</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>y_predict <span class="op">=</span> xgb_class.predict(X_test)</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute test set accuracy.</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>accuracy_score(y_test, y_predict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="85">
<pre><code>0.8713276691575391</code></pre>
</div>
</div>
<p>Conclusion: Our model can accurately identify ~88% of people above and below 50K. But, classes were unbalanced (i.e.&nbsp;their are far more people making &lt;=50K). Thus, one could acheive relatively high overall accuracy by just predicting every sample belongs to the class &lt;=50K. In this situation, it’s better to look at how well the xgboost algorithm predicts specific classes on a few metrics.</p>
</section>
</section>
<section id="recallsensitivity-true-positive-rate" class="level2">
<h2 class="anchored" data-anchor-id="recallsensitivity-true-positive-rate">Recall/Sensitivity (True Positive Rate)</h2>
<p>Recall shows how many positive cases the classifier actually identified as positive.</p>
<section id="manual-calculation-1" class="level3">
<h3 class="anchored" data-anchor-id="manual-calculation-1">Manual Calculation</h3>
<div id="cell-177" class="cell" data-execution_count="86">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually calculate recall/sensitivity.</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>tp<span class="op">/</span>(tp <span class="op">+</span> fn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="86">
<pre><code>0.9457677297806486</code></pre>
</div>
</div>
</section>
<section id="scikitlearn-calculation-1" class="level3">
<h3 class="anchored" data-anchor-id="scikitlearn-calculation-1">ScikitLearn Calculation</h3>
<div id="cell-179" class="cell" data-execution_count="87">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on test set.</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>y_predict <span class="op">=</span> xgb_class.predict(X_test)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute test set recall/sensitivity.</span></span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a>recall_score(y_test, y_predict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="87">
<pre><code>0.9457677297806486</code></pre>
</div>
</div>
<p>Conclusion: 95% of people making &lt;=50K were correctly identified.</p>
</section>
</section>
<section id="precision" class="level2">
<h2 class="anchored" data-anchor-id="precision">Precision</h2>
<p>Precision shows how many positive predictions were actually correct.</p>
<section id="manual-calculation-2" class="level3">
<h3 class="anchored" data-anchor-id="manual-calculation-2">Manual Calculation</h3>
<div id="cell-183" class="cell" data-execution_count="88">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually calculate precision.</span></span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>tp<span class="op">/</span>(tp <span class="op">+</span> fp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>0.8916518650088809</code></pre>
</div>
</div>
</section>
<section id="scikitlearn-calculation-2" class="level3">
<h3 class="anchored" data-anchor-id="scikitlearn-calculation-2">ScikitLearn Calculation</h3>
<div id="cell-185" class="cell" data-execution_count="89">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on test set.</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>y_predict <span class="op">=</span> xgb_class.predict(X_test)</span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute test set precision.</span></span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>precision_score(y_test, y_predict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>0.8916518650088809</code></pre>
</div>
</div>
<p>Conclusion: Of all the times our classifier predicted someone made &lt;=50K, it was correct 89% of the time.</p>
</section>
</section>
<section id="f1-harmonic-mean" class="level2">
<h2 class="anchored" data-anchor-id="f1-harmonic-mean">F1 (Harmonic Mean)</h2>
<p>The F1 score is a combination of recall and precision scores. Importantly, one shouldn’t use the f1 score to assess the model’s accuracy. Rather, the f1 score can be useful for comparing different classifier models.</p>
<section id="manual-calculation-3" class="level3">
<h3 class="anchored" data-anchor-id="manual-calculation-3">Manual Calculation</h3>
<div id="cell-189" class="cell" data-execution_count="90">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually calculate f1 score.</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>(<span class="dv">2</span> <span class="op">*</span> (tp <span class="op">/</span> (tp <span class="op">+</span> fp)) <span class="op">*</span> (tp <span class="op">/</span> (tp <span class="op">+</span> fn))) <span class="op">/</span> ((tp <span class="op">/</span> (tp <span class="op">+</span> fp)) <span class="op">+</span> (tp <span class="op">/</span> (tp <span class="op">+</span> fn)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="90">
<pre><code>0.9179128844772415</code></pre>
</div>
</div>
</section>
<section id="scikitlearn-calculation-3" class="level3">
<h3 class="anchored" data-anchor-id="scikitlearn-calculation-3">ScikitLearn Calculation</h3>
<div id="cell-191" class="cell" data-execution_count="91">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on test set.</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>y_predict <span class="op">=</span> xgb_class.predict(X_test)</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute test set f1 score.</span></span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>f1_score(y_test, y_predict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="91">
<pre><code>0.9179128844772415</code></pre>
</div>
</div>
<p>Conclusion: The harmonic mean is 92%, and is a weighted average between precision and recall.</p>
</section>
</section>
<section id="classification-report" class="level2">
<h2 class="anchored" data-anchor-id="classification-report">Classification Report</h2>
<div id="cell-194" class="cell" data-execution_count="92">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize<span class="op">=</span>(<span class="dv">6</span>, <span class="dv">3</span>))</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification report specificaions.</span></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a>cm_viz <span class="op">=</span> ClassificationReport(xgb_class, classes <span class="op">=</span> [<span class="st">'&gt;50K'</span>, <span class="st">'&lt;=50K'</span>], label_encoder <span class="op">=</span> {<span class="dv">0</span>: <span class="st">'&gt;50K'</span>, <span class="dv">1</span>: <span class="st">'&lt;=50K'</span>}, support <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Get classification report score.</span></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>cm_viz.score(X_test, y_test)</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot classification report.</span></span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>cm_viz.poof()<span class="op">;</span></span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Save classification report plot.</span></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">'images/ClassificationReport.png'</span>, dpi <span class="op">=</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-89-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion:</p>
<p>For the positive class, I have already interpreted the results.</p>
<p>For the negative class, the clssifier seems much less competant overall. First, of all negative predictions it made, it was right 79% of the time (Precision). Second, of all the negative cases the classifier encountered, only 64% were classified correctly (Recall).</p>
<p>If I only cared about identifying people making &lt;=50K, this might be a good classifier. However, because I am tasked with identifying people making &lt;=50K, this classifier is doing what I want. Later I will demonstrate how to manually change the decision threshold to affect these values.</p>
</section>
<section id="roc" class="level2">
<h2 class="anchored" data-anchor-id="roc">ROC</h2>
<p>An ROC illustrates how the classifier performs by tracking the true positive rate (recall/sensitivity) as the false positive rate (inverted specificity) changes. The plot should bulge to the left, indicating a good balance between true and false positives.</p>
<div id="cell-197" class="cell" data-execution_count="93">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup ROC with xgboost model.</span></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>roc_viz <span class="op">=</span> ROCAUC(xgb_class)</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ROC.</span></span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>roc_viz.fit(X_train, y_train) </span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get ROC scores.</span></span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a>roc_viz.score(X_test, y_test)</span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot ROC.</span></span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>roc_viz.poof()<span class="op">;</span></span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Save ROC plot.</span></span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">'images/ROC.png'</span>, dpi <span class="op">=</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-90-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: The plot bulges left, so I have a good classifier. If I were unhappy with the balance betwen true and false positives, the decision threshold could be tweaked to change this curve.</p>
</section>
<section id="precision-recall-curve" class="level2">
<h2 class="anchored" data-anchor-id="precision-recall-curve">Precision-Recall Curve</h2>
<p>The ROC curve may be overly optimistic for imbalanced classes, something this dataset suffers from. Another option for evaluating classifiers is using a precision-recall curve. Classification is a balancing act of finding everything you need (recall) while limiting the junk results (precision). This is typically a trade-off. As recall goes up, precision usually goes down and vice versa.</p>
<div id="cell-200" class="cell" data-execution_count="94">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">6</span>, <span class="dv">4</span>))</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup precision-recall curve with xgboost model.</span></span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>viz <span class="op">=</span> PrecisionRecallCurve(xgb_class)</span>
<span id="cb121-6"><a href="#cb121-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-7"><a href="#cb121-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit precision-recall curve.</span></span>
<span id="cb121-8"><a href="#cb121-8" aria-hidden="true" tabindex="-1"></a>viz.fit(X_train, y_train)</span>
<span id="cb121-9"><a href="#cb121-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-10"><a href="#cb121-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Get precision-recall curve scores.</span></span>
<span id="cb121-11"><a href="#cb121-11" aria-hidden="true" tabindex="-1"></a>viz.score(X_test, y_test)</span>
<span id="cb121-12"><a href="#cb121-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-13"><a href="#cb121-13" aria-hidden="true" tabindex="-1"></a><span class="co"># plot precision-recall curve.</span></span>
<span id="cb121-14"><a href="#cb121-14" aria-hidden="true" tabindex="-1"></a>viz.poof()<span class="op">;</span></span>
<span id="cb121-15"><a href="#cb121-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-16"><a href="#cb121-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Save precision-recall curve plot.</span></span>
<span id="cb121-17"><a href="#cb121-17" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">'images/PrecisionRecallCurve.png'</span>, dpi <span class="op">=</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-91-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: This can give me some indication about how precision and recall change as a function of one another. If I wanted to improve recall, I would need to lower precision (and vis versa).</p>
</section>
<section id="cumulative-gains-plot" class="level2">
<h2 class="anchored" data-anchor-id="cumulative-gains-plot">Cumulative Gains Plot</h2>
<p>This plot visualising the gain in true positives (sensitivity) for a given fraction of the total population targeted by the classifier. As I sample more of the dataset, I can see how it affects the true positive rate. If, for instance, I wanted to find 80% of the population that made &lt;=50K, I could trace the plot below from 0.8 on the y-axis to the blue line, and the corresponding x-axis would tell me the fraction of the populaton I might need to sample to find 80%.</p>
<div id="cell-203" class="cell" data-scrolled="true" data-execution_count="95">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup cumulative gains plot with xgboost model.</span></span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>y_probas <span class="op">=</span> xgb_class.predict_proba(X_test)</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot cumulative gains plot.</span></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>scikitplot.metrics.plot_cumulative_gain(y_test, y_probas, ax <span class="op">=</span> ax)<span class="op">;</span></span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Save cumulative gains plot.</span></span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">'images/CumulativeGains.png'</span>, dpi <span class="op">=</span> <span class="dv">300</span>, bbox_inches <span class="op">=</span> <span class="st">'tight'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-92-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: If there is a cost to contacting people, this may give an idea of how much the cost is. For instance, if I sampled 40% of the dataset, I would already have over 90% of people making &lt;=50K. If this was all I cared about, it may be useful to know that I won’t need to contact 10,000 people in the future. However, at 40% I also have less than 50% of people making &gt;50K. If I wanted to find more than 90% of them, I would potentially need to contact 10,000+ people.</p>
</section>
<section id="lift-curve" class="level2">
<h2 class="anchored" data-anchor-id="lift-curve">Lift Curve</h2>
<p>Lift curve shows the ratio between the proportion of true positive instances in the selection and the proportion of people sampled.</p>
<div id="cell-206" class="cell" data-execution_count="96">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">6</span>, <span class="dv">6</span>))</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup lift curve with xgboost model.</span></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>y_probas <span class="op">=</span> xgb_class.predict_proba(X_test)</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a><span class="co"># plot lift curve.</span></span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>scikitplot.metrics.plot_lift_curve(y_test, y_probas, ax <span class="op">=</span> ax)<span class="op">;</span></span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Save lift curve plot.</span></span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">'images/Lift.png'</span>, dpi <span class="op">=</span> <span class="dv">300</span>, bbox_inches <span class="op">=</span> <span class="st">'tight'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-93-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: The dashed line (baseline) shows how a random classifier would perform. I can see that, if I only sampled 20% of the dataset, I would already find nearly 3.5 times more people making &lt;=50K than a random classifier would find. I see much less improvement regarding the classification of people making &gt;50K, but also no real decrease to lift asmore peaople are sampled.</p>
</section>
<section id="class-prediction-error" class="level2">
<h2 class="anchored" data-anchor-id="class-prediction-error">Class Prediction Error</h2>
<p>This plot will display the same information as the confusion matrix, but also gives a better sense of class balance (which is unbalanced in this dataset).</p>
<div id="cell-209" class="cell" data-execution_count="97">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">8</span>))</span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add class labels.</span></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a>cpe_viz <span class="op">=</span> ClassPredictionError(xgb_class, classes <span class="op">=</span> [<span class="st">'&gt;50K'</span>, <span class="st">'&lt;=50K'</span>])</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit class prediction error plot.</span></span>
<span id="cb124-8"><a href="#cb124-8" aria-hidden="true" tabindex="-1"></a>cpe_viz.score(X_test, y_test)</span>
<span id="cb124-9"><a href="#cb124-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-10"><a href="#cb124-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot class prediction error plot.</span></span>
<span id="cb124-11"><a href="#cb124-11" aria-hidden="true" tabindex="-1"></a>cpe_viz.poof()<span class="op">;</span></span>
<span id="cb124-12"><a href="#cb124-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-13"><a href="#cb124-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Save class prediction error plot.</span></span>
<span id="cb124-14"><a href="#cb124-14" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">'images/ClassPredictionError.png'</span>, dpi <span class="op">=</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-94-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: The top right bar shows the the true positives, the bottom right shows the false negatives, the top left shows the flase positives, and the bottom left shows the true negatives. THese have already been discussed previously.</p>
</section>
<section id="discrimination-threshold" class="level2">
<h2 class="anchored" data-anchor-id="discrimination-threshold">Discrimination Threshold</h2>
<p>Here I will look at the tradeoff between precision and recall, and figure out how to shift the classifier’s decision boundary should I decide to improve one metric over the other.</p>
<p>If I wanted to identify every person who makes &lt;=50K, I would enhance recall over precision, as it would decrease the false negative rate. Subsequently, however, the false positive rate would go up too (because I would be biasing the classifier towards making positive predictions).</p>
<p>Conversely, if I only want to identify people who make &lt;=50K if they actually make &lt;=50K, I would instead enhance precision over recall in order to decrease the false positive rate. However, the false negative rate would also go up (because the classifier would now be biased towards making negative predictions).</p>
<div id="cell-212" class="cell" data-execution_count="98">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(figsize <span class="op">=</span> (<span class="dv">9</span>, <span class="dv">9</span>))<span class="op">;</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Setup discrimination threshold plot with xgboost model.</span></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>dt_viz <span class="op">=</span> DiscriminationThreshold(xgb_class)<span class="op">;</span></span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit discrimination threshold plot.</span></span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>dt_viz.fit(X_test, y_test)<span class="op">;</span></span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot discrimination threshold plot.</span></span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>dt_viz.poof()<span class="op">;</span></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Save discrimination threshold plot.</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>fig.savefig(<span class="st">'images/DiscriminationThreshold.png'</span>, dpi <span class="op">=</span> <span class="dv">300</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-95-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion:In terms of predicting people making &lt;=50K, the model has good overall precision and recall. However, I can tune the model such that one of these metrics is favored over the other. Below, I will do just that.</p>
</section>
</section>
<section id="tuning-decision-threshold" class="level1">
<h1>Tuning Decision Threshold</h1>
<p>Depending on the goal of the project, I may want to change the decision threshold to suite the objective better. First, I will look at the metrics again.</p>
<div id="cell-215" class="cell" data-execution_count="99">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get predictions for confusion matrix.</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> xgb_class.predict(X_test)</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print: precision, recall, accuracy, and f1 score.</span></span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Precision: </span><span class="sc">%.2f</span><span class="st">'</span> <span class="op">%</span> precision_score( y_test, predictions))</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Recall: </span><span class="sc">%.2f</span><span class="st">'</span> <span class="op">%</span> recall_score( y_test, predictions))</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy: </span><span class="sc">%.2f</span><span class="st">'</span> <span class="op">%</span> accuracy_score( y_test, predictions))</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'F1: </span><span class="sc">%.2f</span><span class="st">'</span> <span class="op">%</span> f1_score( y_test, predictions))</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model for confusion matrix.</span></span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix( y_test , predictions)</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Set confusion matrix specifications.</span></span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot <span class="op">=</span> <span class="va">True</span>, annot_kws <span class="op">=</span> {<span class="st">'size'</span>: <span class="dv">25</span>}, fmt <span class="op">=</span> <span class="st">'d'</span>, cmap <span class="op">=</span> <span class="st">'viridis'</span>, cbar <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot confusion matrix.</span></span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Precision: 0.89
Recall: 0.95
Accuracy: 0.87
F1: 0.92</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-96-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<section id="identify-everyone-making-50k" class="level2">
<h2 class="anchored" data-anchor-id="identify-everyone-making-50k">Identify Everyone Making &lt;=50K</h2>
<p>If the goal is to simply maximize the identification people making &lt;=50K, recall should be increased.</p>
<div id="cell-217" class="cell" data-execution_count="100">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lower decision threshold to 0.25.</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>discrimination_threshold <span class="op">=</span> <span class="fl">0.25</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get predictions for confusion matrix.</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> xgb_class.predict_proba(X_test)</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust confusion matrix to account for new decision threshold.</span></span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> (predictions[::,<span class="dv">1</span>] <span class="op">&gt;</span> discrimination_threshold ) <span class="op">*</span> <span class="dv">1</span></span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Print: precision, recall, accuracy, and f1 score.</span></span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The precision score is: </span><span class="sc">%.2f</span><span class="st">'</span> <span class="op">%</span> precision_score( y_test, predictions))</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The recall score is: </span><span class="sc">%.2f</span><span class="st">'</span> <span class="op">%</span> recall_score( y_test, predictions), <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy score is: </span><span class="sc">%.2f</span><span class="st">'</span> <span class="op">%</span> accuracy_score( y_test, predictions))</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The F1 score is: </span><span class="sc">%.2f</span><span class="st">'</span> <span class="op">%</span> f1_score( y_test, predictions))</span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model for confusion matrix.</span></span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix( y_test , predictions)</span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Set confusion matrix specifications.</span></span>
<span id="cb128-23"><a href="#cb128-23" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot <span class="op">=</span> <span class="va">True</span>, annot_kws <span class="op">=</span> {<span class="st">'size'</span>: <span class="dv">25</span>}, fmt <span class="op">=</span> <span class="st">'d'</span>, cmap <span class="op">=</span> <span class="st">'viridis'</span>, cbar <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb128-24"><a href="#cb128-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-25"><a href="#cb128-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot confusion matrix.</span></span>
<span id="cb128-26"><a href="#cb128-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The precision score is: 0.83
The recall score is: 0.99 

Accuracy score is: 0.84
The F1 score is: 0.90</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-97-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: The confusion matrix shows that almost everyone who makes &lt;=50K is correctly identified. However, many more people who make &gt;50K are now classified as making &lt;=50K. If the goal was to find everyone who make &lt;=50K, this might be a better model than the one currently being used.</p>
</section>
<section id="correctly-identify-everyone-making-50k" class="level2">
<h2 class="anchored" data-anchor-id="correctly-identify-everyone-making-50k">Correctly Identify Everyone Making &lt;=50K</h2>
<p>If I don’t want incorrectly identify people making &lt;=50K, precision should be increased.</p>
<div id="cell-220" class="cell" data-execution_count="101">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Raise decision threshold to 0.95.</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>discrimination_threshold <span class="op">=</span> <span class="fl">0.95</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Get predictions for confusion matrix.</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> xgb_class.predict_proba(X_test)</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjust confusion matrix to account for new decision threshold.</span></span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a>predictions <span class="op">=</span> (predictions[::, <span class="dv">1</span>] <span class="op">&gt;</span> discrimination_threshold ) <span class="op">*</span> <span class="dv">1</span></span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-10"><a href="#cb130-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Print: precision, recall, accuracy, and f1 score.</span></span>
<span id="cb130-11"><a href="#cb130-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The precision score is: </span><span class="sc">%.2f</span><span class="st">'</span> <span class="op">%</span> precision_score( y_test, predictions))</span>
<span id="cb130-12"><a href="#cb130-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The recall score is: </span><span class="sc">%.2f</span><span class="st">'</span> <span class="op">%</span> recall_score( y_test, predictions))</span>
<span id="cb130-13"><a href="#cb130-13" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Accuracy score is: </span><span class="sc">%.2f</span><span class="st">'</span> <span class="op">%</span> accuracy_score( y_test, predictions))</span>
<span id="cb130-14"><a href="#cb130-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'The F1 score is: </span><span class="sc">%.2f</span><span class="st">'</span> <span class="op">%</span> f1_score( y_test, predictions))</span>
<span id="cb130-15"><a href="#cb130-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-16"><a href="#cb130-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit model for confusion matrix.</span></span>
<span id="cb130-17"><a href="#cb130-17" aria-hidden="true" tabindex="-1"></a>cm <span class="op">=</span> confusion_matrix( y_test , predictions)</span>
<span id="cb130-18"><a href="#cb130-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-19"><a href="#cb130-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Set plot layout.</span></span>
<span id="cb130-20"><a href="#cb130-20" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb130-21"><a href="#cb130-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-22"><a href="#cb130-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Set confusion matrix specifications.</span></span>
<span id="cb130-23"><a href="#cb130-23" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cm, annot <span class="op">=</span> <span class="va">True</span>, annot_kws <span class="op">=</span> {<span class="st">'size'</span>: <span class="dv">25</span>}, fmt <span class="op">=</span> <span class="st">'d'</span>, cmap <span class="op">=</span> <span class="st">'viridis'</span>, cbar <span class="op">=</span> <span class="va">False</span>)</span>
<span id="cb130-24"><a href="#cb130-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-25"><a href="#cb130-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot confusion matrix.</span></span>
<span id="cb130-26"><a href="#cb130-26" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The precision score is: 0.99
The recall score is: 0.54
Accuracy score is: 0.65
The F1 score is: 0.70</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-98-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: Virtually every person predicted to make &lt;=50K actually made &lt;=50K. However, there are now many more false negatives. But, if I want to make sure every person I identify as making &lt;=50K is actually in that class, this might be a better model.</p>
</section>
</section>
<section id="model-exploration" class="level1">
<h1>Model Exploration</h1>
<p>I’m not going to do much model exploration, but it’s always a good idea to be aware of some tools that might help investigate model outliers, or interesting groupings.</p>
<section id="shapley-additive-explanations-shap" class="level2">
<h2 class="anchored" data-anchor-id="shapley-additive-explanations-shap">Shapley Additive Explanations (SHAP)</h2>
<p>A SHAP plot shows how features each contribute to pushing a model output from the base value (the average model output over the training dataset I passed) to the model output. Features pushing the prediction higher are shown in red, while those pushing the prediction lower are in blue. As an example, I will look at participant 4 (who was predicted to make &lt;=50K).</p>
<div id="cell-224" class="cell" data-execution_count="102">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Explain the xgboost model's predictions using SHAP.</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>explainer <span class="op">=</span> shap.Explainer(xgb_class)</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit SHAP model.</span></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>shap_values <span class="op">=</span> explainer(X_test)</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize a single prediction's prediction's explanation</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>shap.plots.waterfall(shap_values[<span class="dv">3</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-99-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: Factors such as the person being young, working less than 40 hours per week, and having a low status job all contribute greatly to the person being predicted to make &lt;=50K. Interestingly, because the individual is male, this was the only contributing factor to them being pushed towards a prediction of &gt;50K.</p>
</section>
<section id="force-plot" class="level2">
<h2 class="anchored" data-anchor-id="force-plot">Force Plot</h2>
<p>The above graph can also be more concisly displayed using a force plot, which plots the same information as above, but takes less visual space.</p>
<section id="k-force-plot" class="level3">
<h3 class="anchored" data-anchor-id="k-force-plot">&lt;=50K Force Plot</h3>
<div id="cell-228" class="cell" data-execution_count="103">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set javascript display.</span></span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="co">#shap.initjs()</span></span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Assign force plot to xgboost model.</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> shap.TreeExplainer(xgb_class)</span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit force plot.</span></span>
<span id="cb133-8"><a href="#cb133-8" aria-hidden="true" tabindex="-1"></a>shap_vals <span class="op">=</span> s.shap_values(X_test)</span>
<span id="cb133-9"><a href="#cb133-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb133-10"><a href="#cb133-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot force plot.</span></span>
<span id="cb133-11"><a href="#cb133-11" aria-hidden="true" tabindex="-1"></a>shap.force_plot(s.expected_value, shap_vals[<span class="dv">3</span>, :], feature_names <span class="op">=</span> X_test.columns, matplotlib<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-100-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-229" class="cell" data-execution_count="104">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print predicted probability for [&gt;50K, &lt;=50K].</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(xgb_class.predict_proba(X_test.iloc[[<span class="dv">3</span>]]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[6.300807e-04 9.993699e-01]]</code></pre>
</div>
</div>
<p>This person was classified as making &lt;=50K. Again, I can see that their age, hours worked per week, and their job, all contributed the most to them being predicted as making &lt;=50K. Additionally, the predicted probability of them making &lt;=50K is 99.9%.</p>
</section>
<section id="k-force-plot-1" class="level3">
<h3 class="anchored" data-anchor-id="k-force-plot-1">&gt;50K Force Plot</h3>
<div id="cell-232" class="cell" data-execution_count="105">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set javascript display.</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="co">#shap.initjs()</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot force plot.</span></span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>shap.force_plot(s.expected_value, shap_vals[<span class="dv">7</span>, :], feature_names <span class="op">=</span> X_test.columns,  matplotlib<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-102-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="cell-233" class="cell" data-execution_count="106">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot class prediction interval for force plot observation.</span></span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>xgb_class.predict_proba(X_test.iloc[[<span class="dv">7</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="106">
<pre><code>array([[0.9964505 , 0.00354952]], dtype=float32)</code></pre>
</div>
</div>
<p>This person was predicted to make &gt;50K. I can see that their capital_diff score, education level, and hours worked per week, all contributed the most at pushing them towards a high probability of making &gt;50K.</p>
<div id="cell-235" class="cell" data-execution_count="107">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize a single prediction's prediction's explanation</span></span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>shap.plots.waterfall(shap_values[<span class="dv">7</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-104-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Indeed, this person has a large negative captial_diff score (meaning they made money), and they work almost 1 standard deviation above the average.</p>
<p>Conclusion: Force plots a great way to determine why someone might be an outlier, and if their are interesting followups based on group differences. For example, is there something about people with only a preschool education that uniquely contributes to &lt;=50K being a common prediction that does not include education level? These won’t be followed up on here, but they certainly could be interesting avenues to explore.</p>
</section>
</section>
<section id="bee-swarm-plot" class="level2">
<h2 class="anchored" data-anchor-id="bee-swarm-plot">Bee Swarm Plot</h2>
<p>To get an overview of which features are most important for the model’s predictions, I can plot the SHAP values of every feature for every sample. The plot below sorts features by the sum of SHAP value magnitudes over all samples, and uses SHAP values to show the distribution of the impacts each feature has on the model output.</p>
<div id="cell-239" class="cell" data-execution_count="108">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize the effects of all the features.</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>shap.plots.beeswarm(shap_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-105-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: There are some very clear and interesting (albeit obvious) patterns. For instance, almost everyone who is married is predicted to make &gt;50K, and almost everyone who is not married is predicted to make &lt;=50K. For capital_diff, there is no clear amount that helps predict loses, and only when people see capital gains exceeding 4 standard deviations from the mean are they guarenteed to be classified as making &gt;50K. There is also a clear divide amongst those working more or less than 40 hours per week, with those working more making more, and those working less making less. Finally, having a bachelors degree seems to almost guarantee the person will be classified as making &gt;50K.</p>
</section>
<section id="shap-bar-plot" class="level2">
<h2 class="anchored" data-anchor-id="shap-bar-plot">SHAP Bar Plot</h2>
<p>I can also just take the mean absolute value of the SHAP values for each feature to get a standard bar plot.</p>
<div id="cell-242" class="cell" data-execution_count="109">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarise overall effects for most important features.</span></span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>shap.plots.bar(shap_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-106-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conclusion: Here I can see the most important features determining what class someone will be predicted to be in. If I wanted to send out some surveys that targeted people making &lt;=50K, I might want to focus more strongly on those who are younger, unmarried, high school dropouts, and are female. If information like education was more easy to obtain, I could instead find people who did not graduate high school, or those who did but did not attend university.</p>
</section>
<section id="shap-dot-plot" class="level2">
<h2 class="anchored" data-anchor-id="shap-dot-plot">SHAP Dot Plot</h2>
<p>To understand how a single feature affects the output of the model I can plot the SHAP value of that feature vs.&nbsp;the value of the feature for all the examples in a dataset. Vertical dispersion at a single value of a predictor could represent interaction effects with other features. To help reveal these interactions I can color by another feature. If I pass the whole explanation tensor to the color argument the scatter plot will pick the best feature to color by. I will pick a few of the more interesting ones I have found below.</p>
<section id="shap-dot-plot-gender_male" class="level3">
<h3 class="anchored" data-anchor-id="shap-dot-plot-gender_male">SHAP Dot Plot: gender_Male</h3>
<div id="cell-246" class="cell" data-execution_count="110">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot 2 predictors against each other.</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>shap.plots.scatter(shap_values[:, <span class="st">'gender_Male'</span>], color <span class="op">=</span> shap_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-107-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here, it is clear that males are more likely to make &gt;50K than females. however, if either sex has a child, a very strong interaction is observed. Females are more likely to make &gt;50K if they have a child, but males are more likely to make &lt;=50K if they have a child. Thus, having a child affects earnings very differently for either sex. One possibility is child support payments being more likely to be made if you are male, and more likely to be recieved if you are female. If I wanted to target people by sex, it might be useful to contact females without children, or males with children.</p>
</section>
<section id="shap-dot-plot-gender_male-1" class="level3">
<h3 class="anchored" data-anchor-id="shap-dot-plot-gender_male-1">SHAP Dot Plot: gender_Male</h3>
<div id="cell-249" class="cell" data-execution_count="111">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot 2 predictors against each other.</span></span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>shap.plots.scatter(shap_values[:, <span class="st">'hours_per_week'</span>], color <span class="op">=</span> shap_values)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="AdultIncome_files/figure-html/cell-108-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This one is a bit trickier to interpret, but I can try. First, there is a clear divide at 40 hours per week (o on the plot),where people working more than 40 hours making more, and people working less making less. However, if someone has a spouse, this causes an interaction. People working less than 40 hours who have a spouse are more likely to make &gt;50K than those without a spouse, and people working more than 40 hours are less likely to make &gt;50K if they have a spouse. THis second interaction holds no matter how many standard deviations someone is above 40 hours.</p>
</section>
</section>
</section>
<section id="conclusion" class="level1">
<h1>Conclusion</h1>
<p>Now that the model is built, many decisions can be made about precision, recall, etc. The model could then be used to determine which people in a databank are most likely to fall in the category of &lt;=50K.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/www\.stephenpierzchajlo\.com\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2024 - Stephen Pierzchajlo</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




<script src="../../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>